"use strict";!function(){$(function(){$.each($(".art"),function(){new e($(this))}),$.each($(".single-photos-slider__sizes"),function(){new t($(this))})});var e=function(e){var i,s,n=this,a=e,o=new XMLHttpRequest,c=$(window),r=$(window).height(),d=$("body"),l=!0,_=!1,f=a.find(".multi-photos-slider"),u=a.find(".single-photos-slider"),h=u.find(".single-photos-slider__like"),v=a.find(".categories"),p=a.find(".categories__set"),g=a.find(".art__sliders"),m=v.find(".categories__btn"),C=v.find(".categories__name"),w=v.find(".categories__set"),x=$(".site__loading"),k=function(){m.on({click:function(){var e=$(this),t=e.data("id");return x.addClass("show"),j(t),!1}}),v.on("click",".categories__set-item",function(){var e=$(this),t=e.data("slider"),s=a.find(".categories__set-active");return e.hasClass("active")||(v.find(".categories__set-item").removeClass("active"),e.addClass("active"),i.slideTo(t,500)),s.text($(this).text()),s.removeClass("opened"),!1}),c.on({resize:function(){A(f),c.width()<768&&!p.hasClass("categories__set_minimize")?z():c.width()>=768&&!p.hasClass("categories__set_minimize")&&P()},load:function(){setTimeout(function(){A(f)},1),p.hasClass("categories__set_minimize")&&z(),c.width()<768&&!p.hasClass("categories__set_minimize")&&z()}}),a.on("click",".single-photos-slider__like",function(){for(var e,t=$(this),i=t.data("id"),s=t.attr("class").split(" "),n=0;n<s.length;n++)"liked"==s[n]&&(e=s[n]);return B(t,i,e),!1}),d.on({click:function(){var e=p.find(".categories__set-active");e.hasClass("opened")&&e.removeClass("opened")}})},b=function(){v.on("click",".categories__btn",function(){var e=$(this),t=e.data("id");return x.addClass("show"),j(t),!1}),v.on("click",".categories__set-item",function(){var e=$(this),t=e.data("slider"),s=a.find(".categories__set-active");return e.hasClass("active")||(v.find(".categories__set-item").removeClass("active"),e.addClass("active"),i.slideTo(t,500)),s.text($(this).text()),s.removeClass("opened"),!1}),c.on({resize:function(){A(a.find(".multi-photos-slider")),c.width()<768&&!p.hasClass("categories__set_minimize")?z():c.width()>=768&&!p.hasClass("categories__set_minimize")&&P()}}),v.on("click",".categories__set-item",function(){var e=$(this),t=e.data("slider"),s=a.find(".categories__set-active");return e.hasClass("active")||(v.find(".categories__set-item").removeClass("active"),e.addClass("active"),i.slideTo(t,500)),s.text($(this).text()),s.removeClass("opened"),!1}),h.on({click:function(){for(var e,t=$(this),i=t.data("id"),s=t.attr("class").split(" "),n=0;n<s.length;n++)"liked"==s[n]&&(e=s[n]);return B(t,i,e),!1}})},z=function(){l&&(l=!1,p.find(".categories__set-item").wrapAll('<div class="categories__set-drop-down"><div></div></div>'),p.prepend('<span class="categories__set-active">Landscape</span>'),p.find(".categories__set-active").text(p.find(".categories__set-item").filter(".active").text()),_=!0)},T=function(){a[0].obj=n,E(f,u),S(f),k()},E=function(e,t){i=new Swiper(e,{direction:"vertical",slidesPerView:1,paginationClickable:!0,spaceBetween:27,mousewheelControl:!0,onSlideChangeEnd:function(e){v.find(".categories__set-item").removeClass("active"),v.find(".categories__set-item").filter("[data-slider = "+e.activeIndex+"]").addClass("active"),v.find(".categories__set-active").text(v.find(".categories__set-item").filter(".active").text()),$(".single-photos-slider__sizes-selected").removeClass("active")}}),s=new Swiper(t,{nextButton:".swiper-button-next",prevButton:".swiper-button-prev",spaceBetween:30,onSlideChangeEnd:function(){$(".single-photos-slider__sizes-selected").removeClass("active")}})},j=function(e){o.abort(),o=$.ajax({url:v.data("action"),dataType:"json",timeout:2e4,data:"data-id="+e,type:"GET",success:function(t){C.html(""),w.html(""),C.append('<a href="#" class="categories__btn" data-id="'+t.id+'">'+t.btn+"</a>");for(var i=0;i<t.set.length;i++)w.html(function(){$(this).append('<a href="#" class="categories__set-item" data-slider="'+i+'">'+t.set[i]+"</a>")});y(e)},error:function(e){"abort"!=e.statusText&&alert("Error!")}})},y=function(e){o.abort(),o=$.ajax({url:g.data("action"),dataType:"html",timeout:2e4,data:"data-id="+e,type:"GET",success:function(e){l=!0,_=!1,g.html(""),g.append($(e)),setTimeout(function(){E(a.find(".multi-photos-slider"),a.find(".single-photos-slider")),A(a.find(".multi-photos-slider"))},1),b(),c.width()<768&&!p.hasClass("categories__set_minimize")&&z(),$.each($(".single-photos-slider__sizes"),function(){new t($(this))}),new Popup($(".popup")).show(a.find(".single-photos-slider__zoom")),setTimeout(function(){x.removeClass("show")},500)},error:function(e){"abort"!=e.statusText&&alert("Error!")}})},B=function(e,t,i){o.abort(),o=$.ajax({url:e.data("action"),dataType:"json",timeout:2e4,data:{"data-id":t,"class":i},type:"GET",success:function(t){t.like?e.removeClass("liked"):e.addClass("liked")},error:function(e){"abort"!=e.statusText&&alert("Error!")}})},P=function(){if(_){var e=p.find(".categories__set-drop-down div").html();_=!1,p.find(".categories__set-drop-down").remove(),p.find(".categories__set-active").remove(),p.append(e),l=!0}},S=function(e){e.innerHeight(r-e.offset().top)},A=function(e){r=$(window).height(),S(e),i.update()};T()},t=function(e){var t=this,i=e,s=i.find(".single-photos-slider__sizes-selected"),n=i.find(".single-photos-slider__drop"),a=i.find(".single-photos-slider__count"),o=n.find("a"),c=$(window),r=($("body"),function(){s.on({click:function(){d($(this))}}),i.on({click:function(e){e=e||window.event,e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}}),o.on({click:function(){var e=$(this),t=e.text(),i=e.parents(".single-photos-slider__sizes").find(".single-photos-slider__sizes-selected");s.removeClass("active"),o.removeClass("active"),e.addClass("active"),i.text(t),l(e.index()+1)}}),c.on({resize:function(){s.removeClass("active")}})}),d=function(e){var t=e;t.hasClass("active")?t.removeClass("active"):t.addClass("active")},l=function(e){a.find("span:first-child").text(e),a.find("span:last-child").text(o.length)},_=function(){i[0].obj=t,r(),l(o.filter(".active").index()+1)};t.addEventsAfterAjax=function(){s.on({click:function(){d($(this))}}),i.on({click:function(e){e=e||window.event,e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}}),o.on({click:function(){var e=$(this),t=e.text(),i=e.parents(".single-photos-slider__sizes").find(".single-photos-slider__sizes-selected");s.removeClass("active"),o.removeClass("active"),e.addClass("active"),i.text(t),l(e.index()+1)}})},_()}}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpxdWVyeS5saW1pdGVkLWFydC5qcyJdLCJuYW1lcyI6WyIkIiwiZWFjaCIsIkNhdGVnb3J5Q2hhbmdlQ29udGVudCIsInRoaXMiLCJEcm9wRG93biIsIm9iaiIsIl9zd2lwZXJNdWx0aSIsIl9zd2lwZXJTaW5nbGUiLCJfc2VsZiIsIl9vYmoiLCJfcmVxdWVzdCIsIlhNTEh0dHBSZXF1ZXN0IiwiX3dpbmRvdyIsIndpbmRvdyIsIl93aW5kb3dIZWlnaHQiLCJoZWlnaHQiLCJfYm9keSIsIl9mbGFnQWRkIiwiX2ZsYWdSZW1vdmUiLCJfbXVsdGlTbGlkZXIiLCJmaW5kIiwiX3NpbmdsZVNsaWRlciIsIl9saWtlIiwiX2NhdGVnb3JpZXMiLCJfY2F0ZWdvcmllc1NldCIsIl9zbGlkZXJXcmFwIiwiX2J0biIsIl9uYW1lIiwiX3NldFdyYXAiLCJfbG9hZGluZyIsIl9hZGRFdmVudHMiLCJvbiIsImNsaWNrIiwiY3VySXRlbSIsImN1ckl0ZW1EYXRhSWQiLCJkYXRhIiwiYWRkQ2xhc3MiLCJfcmVxdWVzdEZvckNhdGVnb3J5Q29udGVudCIsImN1ckl0ZW1EYXRhU2xpZGVyIiwiYWN0aXZlSXRlbUJ0biIsImhhc0NsYXNzIiwicmVtb3ZlQ2xhc3MiLCJzbGlkZVRvIiwidGV4dCIsInJlc2l6ZSIsIl91cGRhdGVTbGlkZXIiLCJ3aWR0aCIsIl9jaGFuZ2VDYXRlZ29yeVZpZXciLCJfcmVzZXRTdHlsZUNhdGVnb3J5VmlldyIsImxvYWQiLCJzZXRUaW1lb3V0IiwibGlrZWQiLCJjdXJJdGVtQ2xhc3MiLCJhdHRyIiwic3BsaXQiLCJpIiwibGVuZ3RoIiwiX3JlcXVlc3RMaWtlZFBob3RvIiwiX2FkZEV2ZW50c0FmdGVyQWpheCIsIndyYXBBbGwiLCJwcmVwZW5kIiwiZmlsdGVyIiwiX2luaXQiLCJfaW5pdFN3aXBlciIsIl9zZXRIZWlnaHQiLCJtdWx0aSIsInNpbmdsZSIsIlN3aXBlciIsImRpcmVjdGlvbiIsInNsaWRlc1BlclZpZXciLCJwYWdpbmF0aW9uQ2xpY2thYmxlIiwic3BhY2VCZXR3ZWVuIiwibW91c2V3aGVlbENvbnRyb2wiLCJvblNsaWRlQ2hhbmdlRW5kIiwic3dpcGVyIiwiYWN0aXZlSW5kZXgiLCJuZXh0QnV0dG9uIiwicHJldkJ1dHRvbiIsImFib3J0IiwiYWpheCIsInVybCIsImRhdGFUeXBlIiwidGltZW91dCIsInR5cGUiLCJzdWNjZXNzIiwiY29udGVudCIsImh0bWwiLCJhcHBlbmQiLCJpZCIsImJ0biIsInNldCIsIl9yZXF1ZXN0Rm9yU2xpZGVyQ29udGVudCIsImVycm9yIiwic3RhdHVzVGV4dCIsImFsZXJ0IiwiUG9wdXAiLCJzaG93IiwiZWxlbSIsImRhdGFDbGFzcyIsImRhdGEtaWQiLCJjbGFzcyIsImxpa2UiLCJpdGVtcyIsInJlbW92ZSIsImlubmVySGVpZ2h0Iiwib2Zmc2V0IiwidG9wIiwidXBkYXRlIiwiX2Ryb3BNZW51IiwiX2NvdW50QmxvY2siLCJfZHJvcE1lbnVJdGVtIiwiX2NoYW5nZUFjdGl2ZSIsImV2ZW50Iiwic3RvcFByb3BhZ2F0aW9uIiwiY2FuY2VsQnViYmxlIiwiY3VyRWxlbSIsImN1ckVsZW1UZXh0IiwibWFpblRleHRXcmFwIiwicGFyZW50cyIsIl9zZXRDb3VudCIsImluZGV4IiwiYWN0aXZlSXRlbSIsImFkZEV2ZW50c0FmdGVyQWpheCJdLCJtYXBwaW5ncyI6IkFBQUEsY0FDQSxXQUVJQSxFQUFHLFdBRUNBLEVBQUVDLEtBQU1ELEVBQUcsUUFBVSxXQUVqQixHQUFJRSxHQUF3QkYsRUFBR0csU0FJbkNILEVBQUVDLEtBQU1ELEVBQUcsZ0NBQWtDLFdBRXpDLEdBQUlJLEdBQVdKLEVBQUVHLFVBTXpCLElBQUlELEdBQXdCLFNBQVdHLEdBR25DLEdBTUlDLEdBQ0FDLEVBUEFDLEVBQVFMLEtBQ1JNLEVBQU9KLEVBQ1BLLEVBQVcsR0FBSUMsZ0JBQ2ZDLEVBQVVaLEVBQUdhLFFBQ2JDLEVBQWdCZCxFQUFHYSxRQUFRRSxTQUMzQkMsRUFBUWhCLEVBQUcsUUFHWGlCLEdBQVcsRUFDWEMsR0FBYyxFQUNkQyxFQUFlVixFQUFLVyxLQUFNLHdCQUMxQkMsRUFBZ0JaLEVBQUtXLEtBQU0seUJBQzNCRSxFQUFRRCxFQUFjRCxLQUFNLCtCQUM1QkcsRUFBY2QsRUFBS1csS0FBTSxlQUN6QkksRUFBaUJmLEVBQUtXLEtBQU0sb0JBQzVCSyxFQUFjaEIsRUFBS1csS0FBTSxpQkFDekJNLEVBQU9ILEVBQVlILEtBQU0sb0JBQ3pCTyxFQUFRSixFQUFZSCxLQUFNLHFCQUMxQlEsRUFBV0wsRUFBWUgsS0FBTSxvQkFDN0JTLEVBQVc3QixFQUFHLGtCQUdkOEIsRUFBYSxXQUVUSixFQUFLSyxJQUNEQyxNQUFPLFdBQ0gsR0FBSUMsR0FBVWpDLEVBQUdHLE1BQ2IrQixFQUFnQkQsRUFBUUUsS0FBTSxLQU1sQyxPQUpBTixHQUFTTyxTQUFVLFFBRW5CQyxFQUE0QkgsSUFFckIsS0FJZlgsRUFBWVEsR0FBSSxRQUFTLHdCQUF5QixXQUU5QyxHQUFJRSxHQUFVakMsRUFBR0csTUFDYm1DLEVBQW9CTCxFQUFRRSxLQUFNLFVBQ2xDSSxFQUFnQjlCLEVBQUtXLEtBQU0sMEJBVy9CLE9BVE9hLEdBQVFPLFNBQVUsWUFDckJqQixFQUFZSCxLQUFNLHlCQUEwQnFCLFlBQWEsVUFDekRSLEVBQVFHLFNBQVUsVUFDbEI5QixFQUFhb0MsUUFBU0osRUFBbUIsTUFHN0NDLEVBQWNJLEtBQU0zQyxFQUFHRyxNQUFPd0MsUUFDOUJKLEVBQWNFLFlBQWEsV0FFcEIsSUFJWDdCLEVBQVFtQixJQUNKYSxPQUFRLFdBQ0pDLEVBQWUxQixHQUVYUCxFQUFRa0MsUUFBVSxNQUFVdEIsRUFBZWdCLFNBQVUsNEJBQ3JETyxJQUVPbkMsRUFBUWtDLFNBQVcsTUFBVXRCLEVBQWVnQixTQUFVLDZCQUM3RFEsS0FHUkMsS0FBTSxXQUVGQyxXQUFZLFdBQ1JMLEVBQWUxQixJQUNoQixHQUdDSyxFQUFlZ0IsU0FBVSw2QkFDekJPLElBR0FuQyxFQUFRa0MsUUFBVSxNQUFVdEIsRUFBZWdCLFNBQVUsNkJBQ3JETyxPQUtadEMsRUFBS3NCLEdBQUksUUFBUyw4QkFBK0IsV0FNN0MsSUFBSyxHQUZEb0IsR0FIQWxCLEVBQVVqQyxFQUFHRyxNQUNiK0IsRUFBZ0JELEVBQVFFLEtBQU0sTUFDOUJpQixFQUFlbkIsRUFBUW9CLEtBQU0sU0FBU0MsTUFBTSxLQUd2Q0MsRUFBSSxFQUFHQSxFQUFJSCxFQUFhSSxPQUFRRCxJQUVkLFNBQW5CSCxFQUFhRyxLQUNiSixFQUFRQyxFQUFhRyxHQU03QixPQUZBRSxHQUFvQnhCLEVBQVNDLEVBQWVpQixJQUVyQyxJQUdYbkMsRUFBTWUsSUFDRkMsTUFBTyxXQUNILEdBQUlDLEdBQVVULEVBQWVKLEtBQU0sMEJBRS9CYSxHQUFRTyxTQUFVLFdBRWxCUCxFQUFRUSxZQUFhLGNBa0JyQ2lCLEVBQXNCLFdBRWxCbkMsRUFBWVEsR0FBSSxRQUFTLG1CQUFvQixXQUN6QyxHQUFJRSxHQUFVakMsRUFBR0csTUFDYitCLEVBQWdCRCxFQUFRRSxLQUFNLEtBTWxDLE9BSkFOLEdBQVNPLFNBQVUsUUFFbkJDLEVBQTRCSCxJQUVyQixJQUdYWCxFQUFZUSxHQUFJLFFBQVMsd0JBQXlCLFdBRTlDLEdBQUlFLEdBQVVqQyxFQUFHRyxNQUNibUMsRUFBb0JMLEVBQVFFLEtBQU0sVUFDbENJLEVBQWdCOUIsRUFBS1csS0FBTSwwQkFXL0IsT0FUT2EsR0FBUU8sU0FBVSxZQUNyQmpCLEVBQVlILEtBQU0seUJBQTBCcUIsWUFBYSxVQUN6RFIsRUFBUUcsU0FBVSxVQUNsQjlCLEVBQWFvQyxRQUFTSixFQUFtQixNQUc3Q0MsRUFBY0ksS0FBTTNDLEVBQUdHLE1BQU93QyxRQUM5QkosRUFBY0UsWUFBYSxXQUVwQixJQUlYN0IsRUFBUW1CLElBQ0phLE9BQVEsV0FDSkMsRUFBZXBDLEVBQUtXLEtBQU0seUJBRXRCUixFQUFRa0MsUUFBVSxNQUFVdEIsRUFBZWdCLFNBQVUsNEJBQ3JETyxJQUVPbkMsRUFBUWtDLFNBQVcsTUFBVXRCLEVBQWVnQixTQUFVLDZCQUM3RFEsT0FLWnpCLEVBQVlRLEdBQUksUUFBUyx3QkFBeUIsV0FFOUMsR0FBSUUsR0FBVWpDLEVBQUdHLE1BQ2JtQyxFQUFvQkwsRUFBUUUsS0FBTSxVQUNsQ0ksRUFBZ0I5QixFQUFLVyxLQUFNLDBCQVcvQixPQVRPYSxHQUFRTyxTQUFVLFlBQ3JCakIsRUFBWUgsS0FBTSx5QkFBMEJxQixZQUFhLFVBQ3pEUixFQUFRRyxTQUFVLFVBQ2xCOUIsRUFBYW9DLFFBQVNKLEVBQW1CLE1BRzdDQyxFQUFjSSxLQUFNM0MsRUFBR0csTUFBT3dDLFFBQzlCSixFQUFjRSxZQUFhLFdBRXBCLElBSVhuQixFQUFNUyxJQUNGQyxNQUFPLFdBT0gsSUFBSyxHQUZEbUIsR0FIQWxCLEVBQVVqQyxFQUFHRyxNQUNiK0IsRUFBZ0JELEVBQVFFLEtBQU0sTUFDOUJpQixFQUFlbkIsRUFBUW9CLEtBQU0sU0FBU0MsTUFBTSxLQUd2Q0MsRUFBSSxFQUFHQSxFQUFJSCxFQUFhSSxPQUFRRCxJQUVkLFNBQW5CSCxFQUFhRyxLQUNiSixFQUFRQyxFQUFhRyxHQU03QixPQUZBRSxHQUFvQnhCLEVBQVNDLEVBQWVpQixJQUVyQyxNQUtuQkosRUFBc0IsV0FFZDlCLElBQ0FBLEdBQVcsRUFDWE8sRUFBZUosS0FBTSx5QkFBeUJ1QyxRQUFTLDREQUN2RG5DLEVBQWVvQyxRQUFTLHlEQUN4QnBDLEVBQWVKLEtBQU0sMkJBQTRCdUIsS0FBTW5CLEVBQWVKLEtBQU0seUJBQTBCeUMsT0FBUSxXQUFZbEIsUUFDMUh6QixHQUFjLElBSXRCNEMsRUFBUSxXQUVKckQsRUFBSyxHQUFHSixJQUFNRyxFQUNkdUQsRUFBYTVDLEVBQWNFLEdBQzNCMkMsRUFBWTdDLEdBQ1pXLEtBR0ppQyxFQUFjLFNBQVVFLEVBQU9DLEdBRTNCNUQsRUFBZSxHQUFJNkQsUUFBUUYsR0FDdkJHLFVBQVcsV0FDWEMsY0FBZSxFQUNmQyxxQkFBcUIsRUFDckJDLGFBQWMsR0FDZEMsbUJBQW1CLEVBQ25CQyxpQkFBa0IsU0FBVUMsR0FDeEJuRCxFQUFZSCxLQUFNLHlCQUEwQnFCLFlBQWEsVUFDekRsQixFQUFZSCxLQUFNLHlCQUEwQnlDLE9BQVEsa0JBQW9CYSxFQUFPQyxZQUFjLEtBQUt2QyxTQUFVLFVBQzVHYixFQUFZSCxLQUFNLDJCQUE0QnVCLEtBQU1wQixFQUFZSCxLQUFNLHlCQUEwQnlDLE9BQVEsV0FBWWxCLFFBQ3BIM0MsRUFBRyx5Q0FBMEN5QyxZQUFjLGFBR25FbEMsRUFBZ0IsR0FBSTRELFFBQVFELEdBQ3hCVSxXQUFZLHNCQUNaQyxXQUFZLHNCQUNaTixhQUFjLEdBQ2RFLGlCQUFrQixXQUNkekUsRUFBRyx5Q0FBMEN5QyxZQUFjLGNBS3ZFSixFQUE2QixTQUFVRixHQUNuQ3pCLEVBQVNvRSxRQUNUcEUsRUFBV1YsRUFBRStFLE1BQ1RDLElBQUt6RCxFQUFZWSxLQUFNLFVBQ3ZCOEMsU0FBVSxPQUNWQyxRQUFTLElBQ1QvQyxLQUFNLFdBQWFBLEVBQ25CZ0QsS0FBTSxNQUNOQyxRQUFVLFNBQVVDLEdBRWhCMUQsRUFBTTJELEtBQU0sSUFDWjFELEVBQVMwRCxLQUFNLElBRWYzRCxFQUFNNEQsT0FBUSxnREFBa0RGLEVBQVFHLEdBQUssS0FBT0gsRUFBUUksSUFBTSxPQUVsRyxLQUFLLEdBQUlsQyxHQUFJLEVBQUdBLEVBQUk4QixFQUFRSyxJQUFJbEMsT0FBUUQsSUFDcEMzQixFQUFTMEQsS0FBTSxXQUNYdEYsRUFBR0csTUFBT29GLE9BQVEseURBQTJEaEMsRUFBSSxLQUFPOEIsRUFBUUssSUFBS25DLEdBQU0sU0FJbkhvQyxHQUEwQnhELElBSTlCeUQsTUFBTyxTQUFXakYsR0FDb0IsU0FBN0JBLEVBQWVrRixZQUNoQkMsTUFBTyxjQUt2QkgsRUFBMkIsU0FBVXhELEdBQ2pDekIsRUFBU29FLFFBQ1RwRSxFQUFXVixFQUFFK0UsTUFDVEMsSUFBS3ZELEVBQVlVLEtBQU0sVUFDdkI4QyxTQUFVLE9BQ1ZDLFFBQVMsSUFDVC9DLEtBQU0sV0FBYUEsRUFDbkJnRCxLQUFNLE1BQ05DLFFBQVUsU0FBVUMsR0FFaEJwRSxHQUFXLEVBQ1hDLEdBQWMsRUFFZE8sRUFBWTZELEtBQU0sSUFFbEI3RCxFQUFZOEQsT0FBUXZGLEVBQUdxRixJQUV2Qm5DLFdBQVksV0FDUmEsRUFBYXRELEVBQUtXLEtBQU0sd0JBQXlCWCxFQUFLVyxLQUFNLDBCQUM1RHlCLEVBQWVwQyxFQUFLVyxLQUFNLDBCQUMzQixHQUVIc0MsSUFFSTlDLEVBQVFrQyxRQUFVLE1BQVV0QixFQUFlZ0IsU0FBVSw2QkFDckRPLElBSUovQyxFQUFFQyxLQUFNRCxFQUFHLGdDQUFrQyxXQUV6QyxHQUFJSSxHQUFXSixFQUFFRyxTQUlyQixHQUFJNEYsT0FBUS9GLEVBQUcsV0FBYWdHLEtBQU12RixFQUFLVyxLQUFNLGdDQUU3QzhCLFdBQVksV0FDUnJCLEVBQVNZLFlBQWEsU0FDdkIsTUFHUG1ELE1BQU8sU0FBV2pGLEdBQ29CLFNBQTdCQSxFQUFla0YsWUFDaEJDLE1BQU8sY0FLdkJyQyxFQUFxQixTQUFVd0MsRUFBTTlELEVBQU0rRCxHQUN2Q3hGLEVBQVNvRSxRQUNUcEUsRUFBV1YsRUFBRStFLE1BQ1RDLElBQUtpQixFQUFLOUQsS0FBTSxVQUNoQjhDLFNBQVUsT0FDVkMsUUFBUyxJQUNUL0MsTUFDSWdFLFVBQVloRSxFQUNaaUUsUUFBWUYsR0FFaEJmLEtBQU0sTUFDTkMsUUFBVSxTQUFVQyxHQUVYQSxFQUFRZ0IsS0FHVEosRUFBS3hELFlBQWEsU0FGbEJ3RCxFQUFLN0QsU0FBVSxVQU12QndELE1BQU8sU0FBV2pGLEdBQ29CLFNBQTdCQSxFQUFla0YsWUFDaEJDLE1BQU8sY0FLdkI5QyxFQUEwQixXQUV0QixHQUFJOUIsRUFBYyxDQUVkLEdBQUlvRixHQUFROUUsRUFBZUosS0FBTSxrQ0FBa0NrRSxNQUVuRXBFLElBQWMsRUFDZE0sRUFBZUosS0FBTSw4QkFBK0JtRixTQUNwRC9FLEVBQWVKLEtBQU0sMkJBQTRCbUYsU0FDakQvRSxFQUFlK0QsT0FBUWUsR0FDdkJyRixHQUFXLElBSW5CK0MsRUFBYSxTQUFVQyxHQUNuQkEsRUFBTXVDLFlBQWExRixFQUFnQm1ELEVBQU13QyxTQUFTQyxNQUV0RDdELEVBQWdCLFNBQVVvQixHQUN0Qm5ELEVBQWdCZCxFQUFHYSxRQUFTRSxTQUM1QmlELEVBQVlDLEdBQ1ozRCxFQUFhcUcsU0FFckI3QyxNQUlBMUQsRUFBVyxTQUFXQyxHQUd0QixHQUFJRyxHQUFRTCxLQUNSTSxFQUFPSixFQUNQcUIsRUFBT2pCLEVBQUtXLEtBQU0seUNBQ2xCd0YsRUFBWW5HLEVBQUtXLEtBQU0sK0JBQ3ZCeUYsRUFBY3BHLEVBQUtXLEtBQU0sZ0NBQ3pCMEYsRUFBZ0JGLEVBQVV4RixLQUFNLEtBQ2hDUixFQUFVWixFQUFHYSxRQUliaUIsR0FIUTlCLEVBQUcsUUFHRSxXQUVUMEIsRUFBS0ssSUFDREMsTUFBTyxXQUVIK0UsRUFBZS9HLEVBQUdHLFVBSTFCTSxFQUFLc0IsSUFDREMsTUFBTyxTQUFVZ0YsR0FDYkEsRUFBUUEsR0FBU25HLE9BQU9tRyxNQUVuQkEsRUFBTUMsZ0JBQ1BELEVBQU1DLGtCQUVORCxFQUFNRSxjQUFlLEtBSWpDSixFQUFjL0UsSUFDVkMsTUFBTyxXQUVILEdBQUltRixHQUFVbkgsRUFBR0csTUFDYmlILEVBQWNELEVBQVF4RSxPQUN0QjBFLEVBQWVGLEVBQVFHLFFBQVMsZ0NBQWlDbEcsS0FBTSx3Q0FFM0VNLEdBQUtlLFlBQWEsVUFDbEJxRSxFQUFjckUsWUFBYSxVQUMzQjBFLEVBQVEvRSxTQUFVLFVBQ2xCaUYsRUFBYTFFLEtBQU15RSxHQUNuQkcsRUFBV0osRUFBUUssUUFBVSxNQUdyQzVHLEVBQVFtQixJQUNKYSxPQUFRLFdBQ0psQixFQUFLZSxZQUFhLGVBSzlCc0UsRUFBZ0IsU0FBVWQsR0FFdEIsR0FBSWtCLEdBQVVsQixDQUVWa0IsR0FBUTNFLFNBQVUsVUFFbEIyRSxFQUFRMUUsWUFBYSxVQUtyQjBFLEVBQVEvRSxTQUFVLFdBSzFCbUYsRUFBWSxTQUFVRSxHQUNsQlosRUFBWXpGLEtBQU0sb0JBQXFCdUIsS0FBTThFLEdBQzdDWixFQUFZekYsS0FBTSxtQkFBb0J1QixLQUFNbUUsRUFBY3RELFNBRTlETSxFQUFRLFdBQ0pyRCxFQUFNLEdBQUlKLElBQU1HLEVBQ2hCc0IsSUFDQXlGLEVBQVdULEVBQWNqRCxPQUFRLFdBQVkyRCxRQUFVLEdBTS9EaEgsR0FBTWtILG1CQUFxQixXQUN2QmhHLEVBQUtLLElBQ0RDLE1BQU8sV0FFSCtFLEVBQWUvRyxFQUFHRyxVQUkxQk0sRUFBS3NCLElBQ0RDLE1BQU8sU0FBVWdGLEdBQ2JBLEVBQVFBLEdBQVNuRyxPQUFPbUcsTUFFbkJBLEVBQU1DLGdCQUNQRCxFQUFNQyxrQkFFTkQsRUFBTUUsY0FBZSxLQUlqQ0osRUFBYy9FLElBQ1ZDLE1BQU8sV0FFSCxHQUFJbUYsR0FBVW5ILEVBQUdHLE1BQ2JpSCxFQUFjRCxFQUFReEUsT0FDdEIwRSxFQUFlRixFQUFRRyxRQUFTLGdDQUFpQ2xHLEtBQU0sd0NBRTNFTSxHQUFLZSxZQUFhLFVBQ2xCcUUsRUFBY3JFLFlBQWEsVUFDM0IwRSxFQUFRL0UsU0FBVSxVQUNsQmlGLEVBQWExRSxLQUFNeUUsR0FDbkJHLEVBQVdKLEVBQVFLLFFBQVUsT0FLekMxRCIsImZpbGUiOiJsaW1pdGVkLWFydC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbiggZnVuY3Rpb24oKSB7XG5cbiAgICAkKCBmdW5jdGlvbigpIHtcblxuICAgICAgICAkLmVhY2goICQoICcuYXJ0JyApLCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgbmV3IENhdGVnb3J5Q2hhbmdlQ29udGVudCAoICQoIHRoaXMgKSApO1xuXG4gICAgICAgIH0gKTtcblxuICAgICAgICAkLmVhY2goICQoICcuc2luZ2xlLXBob3Rvcy1zbGlkZXJfX3NpemVzJyApLCBmdW5jdGlvbigpe1xuXG4gICAgICAgICAgICBuZXcgRHJvcERvd24gKCAkKHRoaXMpIClcblxuICAgICAgICB9ICk7XG5cbiAgICB9ICk7XG5cbiAgICB2YXIgQ2F0ZWdvcnlDaGFuZ2VDb250ZW50ID0gZnVuY3Rpb24gKCBvYmogKSB7XG5cbiAgICAgICAgLy9wcml2YXRlIHByb3BlcnRpZXNcbiAgICAgICAgdmFyIF9zZWxmID0gdGhpcyxcbiAgICAgICAgICAgIF9vYmogPSBvYmosXG4gICAgICAgICAgICBfcmVxdWVzdCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpLFxuICAgICAgICAgICAgX3dpbmRvdyA9ICQoIHdpbmRvdyksXG4gICAgICAgICAgICBfd2luZG93SGVpZ2h0ID0gJCggd2luZG93KS5oZWlnaHQoKSxcbiAgICAgICAgICAgIF9ib2R5ID0gJCggJ2JvZHknKSxcbiAgICAgICAgICAgIF9zd2lwZXJNdWx0aSxcbiAgICAgICAgICAgIF9zd2lwZXJTaW5nbGUsXG4gICAgICAgICAgICBfZmxhZ0FkZCA9IHRydWUsXG4gICAgICAgICAgICBfZmxhZ1JlbW92ZSA9IGZhbHNlLFxuICAgICAgICAgICAgX211bHRpU2xpZGVyID0gX29iai5maW5kKCAnLm11bHRpLXBob3Rvcy1zbGlkZXInICksXG4gICAgICAgICAgICBfc2luZ2xlU2xpZGVyID0gX29iai5maW5kKCAnLnNpbmdsZS1waG90b3Mtc2xpZGVyJyApLFxuICAgICAgICAgICAgX2xpa2UgPSBfc2luZ2xlU2xpZGVyLmZpbmQoICcuc2luZ2xlLXBob3Rvcy1zbGlkZXJfX2xpa2UnICksXG4gICAgICAgICAgICBfY2F0ZWdvcmllcyA9IF9vYmouZmluZCggJy5jYXRlZ29yaWVzJyApLFxuICAgICAgICAgICAgX2NhdGVnb3JpZXNTZXQgPSBfb2JqLmZpbmQoICcuY2F0ZWdvcmllc19fc2V0JyApLFxuICAgICAgICAgICAgX3NsaWRlcldyYXAgPSBfb2JqLmZpbmQoICcuYXJ0X19zbGlkZXJzJyksXG4gICAgICAgICAgICBfYnRuID0gX2NhdGVnb3JpZXMuZmluZCggJy5jYXRlZ29yaWVzX19idG4nICksXG4gICAgICAgICAgICBfbmFtZSA9IF9jYXRlZ29yaWVzLmZpbmQoICcuY2F0ZWdvcmllc19fbmFtZScgKSxcbiAgICAgICAgICAgIF9zZXRXcmFwID0gX2NhdGVnb3JpZXMuZmluZCggJy5jYXRlZ29yaWVzX19zZXQnKSxcbiAgICAgICAgICAgIF9sb2FkaW5nID0gJCggJy5zaXRlX19sb2FkaW5nJyApO1xuXG4gICAgICAgIC8vcHJpdmF0ZSBtZXRob2RzXG4gICAgICAgIHZhciBfYWRkRXZlbnRzID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICBfYnRuLm9uKCB7XG4gICAgICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdXJJdGVtID0gJCggdGhpcyApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1ckl0ZW1EYXRhSWQgPSBjdXJJdGVtLmRhdGEoICdpZCcgKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX2xvYWRpbmcuYWRkQ2xhc3MoICdzaG93JyApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfcmVxdWVzdEZvckNhdGVnb3J5Q29udGVudCggY3VySXRlbURhdGFJZCApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICBfY2F0ZWdvcmllcy5vbiggJ2NsaWNrJywgJy5jYXRlZ29yaWVzX19zZXQtaXRlbScsIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBjdXJJdGVtID0gJCggdGhpcyksXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJJdGVtRGF0YVNsaWRlciA9IGN1ckl0ZW0uZGF0YSggJ3NsaWRlcicpLFxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlSXRlbUJ0biA9IF9vYmouZmluZCggJy5jYXRlZ29yaWVzX19zZXQtYWN0aXZlJyApO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmKCAhKCBjdXJJdGVtLmhhc0NsYXNzKCAnYWN0aXZlJyApICkgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfY2F0ZWdvcmllcy5maW5kKCAnLmNhdGVnb3JpZXNfX3NldC1pdGVtJyApLnJlbW92ZUNsYXNzKCAnYWN0aXZlJyApO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VySXRlbS5hZGRDbGFzcyggJ2FjdGl2ZScgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9zd2lwZXJNdWx0aS5zbGlkZVRvKCBjdXJJdGVtRGF0YVNsaWRlciwgNTAwICk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBhY3RpdmVJdGVtQnRuLnRleHQoICQoIHRoaXMgKS50ZXh0KCkgKTtcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZlSXRlbUJ0bi5yZW1vdmVDbGFzcyggJ29wZW5lZCcgKTtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICBfd2luZG93Lm9uKCB7XG4gICAgICAgICAgICAgICAgICAgIHJlc2l6ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3VwZGF0ZVNsaWRlciggX211bHRpU2xpZGVyICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBfd2luZG93LndpZHRoKCkgPCA3NjggJiYgISggX2NhdGVnb3JpZXNTZXQuaGFzQ2xhc3MoICdjYXRlZ29yaWVzX19zZXRfbWluaW1pemUnICkgKSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY2hhbmdlQ2F0ZWdvcnlWaWV3KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiggX3dpbmRvdy53aWR0aCgpID49IDc2OCAmJiAhKCBfY2F0ZWdvcmllc1NldC5oYXNDbGFzcyggJ2NhdGVnb3JpZXNfX3NldF9taW5pbWl6ZScgKSApICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9yZXNldFN0eWxlQ2F0ZWdvcnlWaWV3KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGxvYWQ6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCggZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3VwZGF0ZVNsaWRlciggX211bHRpU2xpZGVyICk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAxICk7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIF9jYXRlZ29yaWVzU2V0Lmhhc0NsYXNzKCAnY2F0ZWdvcmllc19fc2V0X21pbmltaXplJyApICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jaGFuZ2VDYXRlZ29yeVZpZXcoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIF93aW5kb3cud2lkdGgoKSA8IDc2OCAmJiAhKCBfY2F0ZWdvcmllc1NldC5oYXNDbGFzcyggJ2NhdGVnb3JpZXNfX3NldF9taW5pbWl6ZScgKSApICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jaGFuZ2VDYXRlZ29yeVZpZXcoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgICAgIF9vYmoub24oICdjbGljaycsICcuc2luZ2xlLXBob3Rvcy1zbGlkZXJfX2xpa2UnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1ckl0ZW0gPSAkKCB0aGlzICksXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJJdGVtRGF0YUlkID0gY3VySXRlbS5kYXRhKCAnaWQnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1ckl0ZW1DbGFzcyA9IGN1ckl0ZW0uYXR0ciggJ2NsYXNzJykuc3BsaXQoJyAnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpa2VkO1xuXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY3VySXRlbUNsYXNzLmxlbmd0aDsgaSsrKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBjdXJJdGVtQ2xhc3NbaV0gPT0gJ2xpa2VkJyApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWtlZCA9IGN1ckl0ZW1DbGFzc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIF9yZXF1ZXN0TGlrZWRQaG90byggY3VySXRlbSwgY3VySXRlbURhdGFJZCwgbGlrZWQgKTtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgX2JvZHkub24oIHtcbiAgICAgICAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1ckl0ZW0gPSBfY2F0ZWdvcmllc1NldC5maW5kKCAnLmNhdGVnb3JpZXNfX3NldC1hY3RpdmUnICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBjdXJJdGVtLmhhc0NsYXNzKCAnb3BlbmVkJyApICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VySXRlbS5yZW1vdmVDbGFzcyggJ29wZW5lZCcgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9hZGROaWNlU2Nyb2xsID0gZnVuY3Rpb24oIGVsZW0gKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRyb3BNZW51ID0gZWxlbSxcbiAgICAgICAgICAgICAgICAgICAgZHJvcE1lbnVEaXYgPSBkcm9wTWVudS5maW5kKCAnZGl2JyksXG4gICAgICAgICAgICAgICAgICAgIGRyb3BNZW51RGl2SGVpZ2h0ID0gZHJvcE1lbnVEaXYub3V0ZXJIZWlnaHQoKSxcbiAgICAgICAgICAgICAgICAgICAgbWF4SGVpZ2h0ID0gZHJvcE1lbnUuY3NzKCAnbWF4LWhlaWdodCcgKTtcblxuICAgICAgICAgICAgICAgIGlmKCBkcm9wTWVudURpdkhlaWdodCA+IHBhcnNlSW50KG1heEhlaWdodCkgKSB7XG4gICAgICAgICAgICAgICAgICAgIGRyb3BNZW51Lm5pY2VTY3JvbGwoIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhvcml6cmFpbGVuYWJsZWQ6IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgIH0gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2FkZEV2ZW50c0FmdGVyQWpheCA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgX2NhdGVnb3JpZXMub24oICdjbGljaycsICcuY2F0ZWdvcmllc19fYnRuJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjdXJJdGVtID0gJCggdGhpcyApLFxuICAgICAgICAgICAgICAgICAgICAgICAgY3VySXRlbURhdGFJZCA9IGN1ckl0ZW0uZGF0YSggJ2lkJyApO1xuXG4gICAgICAgICAgICAgICAgICAgIF9sb2FkaW5nLmFkZENsYXNzKCAnc2hvdycgKTtcblxuICAgICAgICAgICAgICAgICAgICBfcmVxdWVzdEZvckNhdGVnb3J5Q29udGVudCggY3VySXRlbURhdGFJZCApO1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICBfY2F0ZWdvcmllcy5vbiggJ2NsaWNrJywgJy5jYXRlZ29yaWVzX19zZXQtaXRlbScsIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBjdXJJdGVtID0gJCggdGhpcyksXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJJdGVtRGF0YVNsaWRlciA9IGN1ckl0ZW0uZGF0YSggJ3NsaWRlcicpLFxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlSXRlbUJ0biA9IF9vYmouZmluZCggJy5jYXRlZ29yaWVzX19zZXQtYWN0aXZlJyApO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmKCAhKCBjdXJJdGVtLmhhc0NsYXNzKCAnYWN0aXZlJyApICkgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfY2F0ZWdvcmllcy5maW5kKCAnLmNhdGVnb3JpZXNfX3NldC1pdGVtJyApLnJlbW92ZUNsYXNzKCAnYWN0aXZlJyApO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VySXRlbS5hZGRDbGFzcyggJ2FjdGl2ZScgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9zd2lwZXJNdWx0aS5zbGlkZVRvKCBjdXJJdGVtRGF0YVNsaWRlciwgNTAwICk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBhY3RpdmVJdGVtQnRuLnRleHQoICQoIHRoaXMgKS50ZXh0KCkgKTtcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZlSXRlbUJ0bi5yZW1vdmVDbGFzcyggJ29wZW5lZCcgKTtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICBfd2luZG93Lm9uKCB7XG4gICAgICAgICAgICAgICAgICAgIHJlc2l6ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3VwZGF0ZVNsaWRlciggX29iai5maW5kKCAnLm11bHRpLXBob3Rvcy1zbGlkZXInKSApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiggX3dpbmRvdy53aWR0aCgpIDwgNzY4ICYmICEoIF9jYXRlZ29yaWVzU2V0Lmhhc0NsYXNzKCAnY2F0ZWdvcmllc19fc2V0X21pbmltaXplJyApICkgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NoYW5nZUNhdGVnb3J5VmlldygpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYoIF93aW5kb3cud2lkdGgoKSA+PSA3NjggJiYgISggX2NhdGVnb3JpZXNTZXQuaGFzQ2xhc3MoICdjYXRlZ29yaWVzX19zZXRfbWluaW1pemUnICkgKSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcmVzZXRTdHlsZUNhdGVnb3J5VmlldygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgX2NhdGVnb3JpZXMub24oICdjbGljaycsICcuY2F0ZWdvcmllc19fc2V0LWl0ZW0nLCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgY3VySXRlbSA9ICQoIHRoaXMpLFxuICAgICAgICAgICAgICAgICAgICAgICAgY3VySXRlbURhdGFTbGlkZXIgPSBjdXJJdGVtLmRhdGEoICdzbGlkZXInKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZUl0ZW1CdG4gPSBfb2JqLmZpbmQoICcuY2F0ZWdvcmllc19fc2V0LWFjdGl2ZScgKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiggISggY3VySXRlbS5oYXNDbGFzcyggJ2FjdGl2ZScgKSApICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX2NhdGVnb3JpZXMuZmluZCggJy5jYXRlZ29yaWVzX19zZXQtaXRlbScgKS5yZW1vdmVDbGFzcyggJ2FjdGl2ZScgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1ckl0ZW0uYWRkQ2xhc3MoICdhY3RpdmUnICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfc3dpcGVyTXVsdGkuc2xpZGVUbyggY3VySXRlbURhdGFTbGlkZXIsIDUwMCApO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgYWN0aXZlSXRlbUJ0bi50ZXh0KCAkKCB0aGlzICkudGV4dCgpICk7XG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZUl0ZW1CdG4ucmVtb3ZlQ2xhc3MoICdvcGVuZWQnICk7XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgX2xpa2Uub24oIHtcbiAgICAgICAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VySXRlbSA9ICQoIHRoaXMgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJJdGVtRGF0YUlkID0gY3VySXRlbS5kYXRhKCAnaWQnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJJdGVtQ2xhc3MgPSBjdXJJdGVtLmF0dHIoICdjbGFzcycpLnNwbGl0KCcgJyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlrZWQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY3VySXRlbUNsYXNzLmxlbmd0aDsgaSsrKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiggY3VySXRlbUNsYXNzW2ldID09ICdsaWtlZCcgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpa2VkID0gY3VySXRlbUNsYXNzW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgX3JlcXVlc3RMaWtlZFBob3RvKCBjdXJJdGVtLCBjdXJJdGVtRGF0YUlkLCBsaWtlZCApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfY2hhbmdlQ2F0ZWdvcnlWaWV3ID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICBpZiggX2ZsYWdBZGQgKSB7XG4gICAgICAgICAgICAgICAgICAgIF9mbGFnQWRkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIF9jYXRlZ29yaWVzU2V0LmZpbmQoICcuY2F0ZWdvcmllc19fc2V0LWl0ZW0nKS53cmFwQWxsKCAnPGRpdiBjbGFzcz1cImNhdGVnb3JpZXNfX3NldC1kcm9wLWRvd25cIj48ZGl2PjwvZGl2PjwvZGl2PicgKTtcbiAgICAgICAgICAgICAgICAgICAgX2NhdGVnb3JpZXNTZXQucHJlcGVuZCggJzxzcGFuIGNsYXNzPVwiY2F0ZWdvcmllc19fc2V0LWFjdGl2ZVwiPkxhbmRzY2FwZTwvc3Bhbj4nICk7XG4gICAgICAgICAgICAgICAgICAgIF9jYXRlZ29yaWVzU2V0LmZpbmQoICcuY2F0ZWdvcmllc19fc2V0LWFjdGl2ZScgKS50ZXh0KCBfY2F0ZWdvcmllc1NldC5maW5kKCAnLmNhdGVnb3JpZXNfX3NldC1pdGVtJyApLmZpbHRlciggJy5hY3RpdmUnICkudGV4dCgpICk7XG4gICAgICAgICAgICAgICAgICAgIF9mbGFnUmVtb3ZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfaW5pdCA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgX29ialswXS5vYmogPSBfc2VsZjtcbiAgICAgICAgICAgICAgICBfaW5pdFN3aXBlciggX211bHRpU2xpZGVyLCBfc2luZ2xlU2xpZGVyICk7XG4gICAgICAgICAgICAgICAgX3NldEhlaWdodCggX211bHRpU2xpZGVyICk7XG4gICAgICAgICAgICAgICAgX2FkZEV2ZW50cygpO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2luaXRTd2lwZXIgPSBmdW5jdGlvbiggbXVsdGksIHNpbmdsZSApIHtcblxuICAgICAgICAgICAgICAgIF9zd2lwZXJNdWx0aSA9IG5ldyBTd2lwZXIoIG11bHRpLCB7XG4gICAgICAgICAgICAgICAgICAgIGRpcmVjdGlvbjogJ3ZlcnRpY2FsJyxcbiAgICAgICAgICAgICAgICAgICAgc2xpZGVzUGVyVmlldzogMSxcbiAgICAgICAgICAgICAgICAgICAgcGFnaW5hdGlvbkNsaWNrYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgc3BhY2VCZXR3ZWVuOiAyNyxcbiAgICAgICAgICAgICAgICAgICAgbW91c2V3aGVlbENvbnRyb2w6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIG9uU2xpZGVDaGFuZ2VFbmQ6IGZ1bmN0aW9uKCBzd2lwZXIgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfY2F0ZWdvcmllcy5maW5kKCAnLmNhdGVnb3JpZXNfX3NldC1pdGVtJyApLnJlbW92ZUNsYXNzKCAnYWN0aXZlJyApO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2NhdGVnb3JpZXMuZmluZCggJy5jYXRlZ29yaWVzX19zZXQtaXRlbScgKS5maWx0ZXIoICdbZGF0YS1zbGlkZXIgPSAnICsgc3dpcGVyLmFjdGl2ZUluZGV4ICsgJ10nKS5hZGRDbGFzcyggJ2FjdGl2ZScgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jYXRlZ29yaWVzLmZpbmQoICcuY2F0ZWdvcmllc19fc2V0LWFjdGl2ZScgKS50ZXh0KCBfY2F0ZWdvcmllcy5maW5kKCAnLmNhdGVnb3JpZXNfX3NldC1pdGVtJyApLmZpbHRlciggJy5hY3RpdmUnICkudGV4dCgpICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKCAnLnNpbmdsZS1waG90b3Mtc2xpZGVyX19zaXplcy1zZWxlY3RlZCcgKS5yZW1vdmVDbGFzcyAoICdhY3RpdmUnIClcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gKTtcbiAgICAgICAgICAgICAgICBfc3dpcGVyU2luZ2xlID0gbmV3IFN3aXBlciggc2luZ2xlLCB7XG4gICAgICAgICAgICAgICAgICAgIG5leHRCdXR0b246ICcuc3dpcGVyLWJ1dHRvbi1uZXh0JyxcbiAgICAgICAgICAgICAgICAgICAgcHJldkJ1dHRvbjogJy5zd2lwZXItYnV0dG9uLXByZXYnLFxuICAgICAgICAgICAgICAgICAgICBzcGFjZUJldHdlZW46IDMwLFxuICAgICAgICAgICAgICAgICAgICBvblNsaWRlQ2hhbmdlRW5kOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICQoICcuc2luZ2xlLXBob3Rvcy1zbGlkZXJfX3NpemVzLXNlbGVjdGVkJyApLnJlbW92ZUNsYXNzICggJ2FjdGl2ZScgKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX3JlcXVlc3RGb3JDYXRlZ29yeUNvbnRlbnQgPSBmdW5jdGlvbiggZGF0YSApIHtcbiAgICAgICAgICAgICAgICBfcmVxdWVzdC5hYm9ydCgpO1xuICAgICAgICAgICAgICAgIF9yZXF1ZXN0ID0gJC5hamF4KCB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogX2NhdGVnb3JpZXMuZGF0YSggJ2FjdGlvbicgKSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJyxcbiAgICAgICAgICAgICAgICAgICAgdGltZW91dDogMjAwMDAsXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6ICdkYXRhLWlkPScgKyBkYXRhICxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJHRVRcIixcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzcyA6IGZ1bmN0aW9uKCBjb250ZW50ICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfbmFtZS5odG1sKCAnJyApO1xuICAgICAgICAgICAgICAgICAgICAgICAgX3NldFdyYXAuaHRtbCggJycgKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX25hbWUuYXBwZW5kKCAnPGEgaHJlZj1cIiNcIiBjbGFzcz1cImNhdGVnb3JpZXNfX2J0blwiIGRhdGEtaWQ9XCInICsgY29udGVudC5pZCArICdcIj4nICsgY29udGVudC5idG4gKyAnPC9hPicgKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yKCB2YXIgaSA9IDA7IGkgPCBjb250ZW50LnNldC5sZW5ndGg7IGkrKyApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfc2V0V3JhcC5odG1sKCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCggdGhpcyApLmFwcGVuZCggJzxhIGhyZWY9XCIjXCIgY2xhc3M9XCJjYXRlZ29yaWVzX19zZXQtaXRlbVwiIGRhdGEtc2xpZGVyPVwiJyArIGkgKyAnXCI+JyArIGNvbnRlbnQuc2V0WyBpIF0gKyAnPC9hPicgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgX3JlcXVlc3RGb3JTbGlkZXJDb250ZW50KCBkYXRhICk7XG5cblxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKCBYTUxIdHRwUmVxdWVzdCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggWE1MSHR0cFJlcXVlc3Quc3RhdHVzVGV4dCAhPSBcImFib3J0XCIgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoICdFcnJvciEnICk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX3JlcXVlc3RGb3JTbGlkZXJDb250ZW50ID0gZnVuY3Rpb24oIGRhdGEgKSB7XG4gICAgICAgICAgICAgICAgX3JlcXVlc3QuYWJvcnQoKTtcbiAgICAgICAgICAgICAgICBfcmVxdWVzdCA9ICQuYWpheCgge1xuICAgICAgICAgICAgICAgICAgICB1cmw6IF9zbGlkZXJXcmFwLmRhdGEoICdhY3Rpb24nICksXG4gICAgICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAnaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIHRpbWVvdXQ6IDIwMDAwLFxuICAgICAgICAgICAgICAgICAgICBkYXRhOiAnZGF0YS1pZD0nICsgZGF0YSAsXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiR0VUXCIsXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3MgOiBmdW5jdGlvbiggY29udGVudCApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX2ZsYWdBZGQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2ZsYWdSZW1vdmUgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX3NsaWRlcldyYXAuaHRtbCggJycgKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX3NsaWRlcldyYXAuYXBwZW5kKCAkKCBjb250ZW50ICkgKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCggZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2luaXRTd2lwZXIoIF9vYmouZmluZCggJy5tdWx0aS1waG90b3Mtc2xpZGVyJyksIF9vYmouZmluZCggJy5zaW5nbGUtcGhvdG9zLXNsaWRlcicpICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3VwZGF0ZVNsaWRlciggX29iai5maW5kKCAnLm11bHRpLXBob3Rvcy1zbGlkZXInKSApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgMSApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfYWRkRXZlbnRzQWZ0ZXJBamF4KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBfd2luZG93LndpZHRoKCkgPCA3NjggJiYgISggX2NhdGVnb3JpZXNTZXQuaGFzQ2xhc3MoICdjYXRlZ29yaWVzX19zZXRfbWluaW1pemUnICkgKSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY2hhbmdlQ2F0ZWdvcnlWaWV3KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgJC5lYWNoKCAkKCAnLnNpbmdsZS1waG90b3Mtc2xpZGVyX19zaXplcycgKSwgZnVuY3Rpb24oKXtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBEcm9wRG93biAoICQodGhpcykgKVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBQb3B1cCAoICQoICcucG9wdXAnICkgKS5zaG93KCBfb2JqLmZpbmQoICcuc2luZ2xlLXBob3Rvcy1zbGlkZXJfX3pvb20nICkgKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCggZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2xvYWRpbmcucmVtb3ZlQ2xhc3MoICdzaG93JyApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgNTAwICk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICggWE1MSHR0cFJlcXVlc3QgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIFhNTEh0dHBSZXF1ZXN0LnN0YXR1c1RleHQgIT0gXCJhYm9ydFwiICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KCAnRXJyb3IhJyApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9yZXF1ZXN0TGlrZWRQaG90byA9IGZ1bmN0aW9uKCBlbGVtLCBkYXRhLCBkYXRhQ2xhc3MgKSB7XG4gICAgICAgICAgICAgICAgX3JlcXVlc3QuYWJvcnQoKTtcbiAgICAgICAgICAgICAgICBfcmVxdWVzdCA9ICQuYWpheCgge1xuICAgICAgICAgICAgICAgICAgICB1cmw6IGVsZW0uZGF0YSggJ2FjdGlvbicgKSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJyxcbiAgICAgICAgICAgICAgICAgICAgdGltZW91dDogMjAwMDAsXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdkYXRhLWlkJzogIGRhdGEgLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2NsYXNzJzogICAgZGF0YUNsYXNzXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiR0VUXCIsXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3MgOiBmdW5jdGlvbiggY29udGVudCApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoICFjb250ZW50Lmxpa2UgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbS5hZGRDbGFzcyggJ2xpa2VkJyApXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW0ucmVtb3ZlQ2xhc3MoICdsaWtlZCcgKVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoIFhNTEh0dHBSZXF1ZXN0ICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBYTUxIdHRwUmVxdWVzdC5zdGF0dXNUZXh0ICE9IFwiYWJvcnRcIiApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGVydCggJ0Vycm9yIScgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfcmVzZXRTdHlsZUNhdGVnb3J5VmlldyA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgaWYoIF9mbGFnUmVtb3ZlICkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBpdGVtcyA9IF9jYXRlZ29yaWVzU2V0LmZpbmQoICcuY2F0ZWdvcmllc19fc2V0LWRyb3AtZG93biBkaXYnKS5odG1sKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgX2ZsYWdSZW1vdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgX2NhdGVnb3JpZXNTZXQuZmluZCggJy5jYXRlZ29yaWVzX19zZXQtZHJvcC1kb3duJyApLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICAgICBfY2F0ZWdvcmllc1NldC5maW5kKCAnLmNhdGVnb3JpZXNfX3NldC1hY3RpdmUnICkucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgICAgIF9jYXRlZ29yaWVzU2V0LmFwcGVuZCggaXRlbXMgKTtcbiAgICAgICAgICAgICAgICAgICAgX2ZsYWdBZGQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9zZXRIZWlnaHQgPSBmdW5jdGlvbiggbXVsdGkgKSB7XG4gICAgICAgICAgICAgICAgbXVsdGkuaW5uZXJIZWlnaHQoIF93aW5kb3dIZWlnaHQgLSBtdWx0aS5vZmZzZXQoKS50b3AgKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfdXBkYXRlU2xpZGVyID0gZnVuY3Rpb24oIG11bHRpICkge1xuICAgICAgICAgICAgICAgIF93aW5kb3dIZWlnaHQgPSAkKCB3aW5kb3cgKS5oZWlnaHQoKTtcbiAgICAgICAgICAgICAgICBfc2V0SGVpZ2h0KCBtdWx0aSApO1xuICAgICAgICAgICAgICAgIF9zd2lwZXJNdWx0aS51cGRhdGUoKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIF9pbml0KCk7XG5cbiAgICB9O1xuXG4gICAgdmFyIERyb3BEb3duID0gZnVuY3Rpb24gKCBvYmogKSB7XG5cbiAgICAgICAgLy9wcml2YXRlIHByb3BlcnRpZXNcbiAgICAgICAgdmFyIF9zZWxmID0gdGhpcyxcbiAgICAgICAgICAgIF9vYmogPSBvYmosXG4gICAgICAgICAgICBfYnRuID0gX29iai5maW5kKCAnLnNpbmdsZS1waG90b3Mtc2xpZGVyX19zaXplcy1zZWxlY3RlZCcgKSxcbiAgICAgICAgICAgIF9kcm9wTWVudSA9IF9vYmouZmluZCggJy5zaW5nbGUtcGhvdG9zLXNsaWRlcl9fZHJvcCcpLFxuICAgICAgICAgICAgX2NvdW50QmxvY2sgPSBfb2JqLmZpbmQoICcuc2luZ2xlLXBob3Rvcy1zbGlkZXJfX2NvdW50JyksXG4gICAgICAgICAgICBfZHJvcE1lbnVJdGVtID0gX2Ryb3BNZW51LmZpbmQoICdhJyApLFxuICAgICAgICAgICAgX3dpbmRvdyA9ICQoIHdpbmRvdyApLFxuICAgICAgICAgICAgX2JvZHkgPSAkKCAnYm9keScgKTtcblxuICAgICAgICAvL3ByaXZhdGUgbWV0aG9kc1xuICAgICAgICB2YXIgX2FkZEV2ZW50cyA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgX2J0bi5vbigge1xuICAgICAgICAgICAgICAgICAgICBjbGljazogZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIF9jaGFuZ2VBY3RpdmUoICQoIHRoaXMgKSApO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICAgICAgX29iai5vbigge1xuICAgICAgICAgICAgICAgICAgICBjbGljazogZnVuY3Rpb24oIGV2ZW50ICl7XG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudCA9IGV2ZW50IHx8IHdpbmRvdy5ldmVudDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBldmVudC5zdG9wUHJvcGFnYXRpb24gKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LmNhbmNlbEJ1YmJsZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICAgICAgX2Ryb3BNZW51SXRlbS5vbigge1xuICAgICAgICAgICAgICAgICAgICBjbGljazogZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdXJFbGVtID0gJCggdGhpcyApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1ckVsZW1UZXh0ID0gY3VyRWxlbS50ZXh0KCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFpblRleHRXcmFwID0gY3VyRWxlbS5wYXJlbnRzKCAnLnNpbmdsZS1waG90b3Mtc2xpZGVyX19zaXplcycgKS5maW5kKCAnLnNpbmdsZS1waG90b3Mtc2xpZGVyX19zaXplcy1zZWxlY3RlZCcgKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX2J0bi5yZW1vdmVDbGFzcyggJ2FjdGl2ZScgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9kcm9wTWVudUl0ZW0ucmVtb3ZlQ2xhc3MoICdhY3RpdmUnICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJFbGVtLmFkZENsYXNzKCAnYWN0aXZlJyApO1xuICAgICAgICAgICAgICAgICAgICAgICAgbWFpblRleHRXcmFwLnRleHQoIGN1ckVsZW1UZXh0ICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfc2V0Q291bnQoIGN1ckVsZW0uaW5kZXgoKSArIDEgKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gKTtcbiAgICAgICAgICAgICAgICBfd2luZG93Lm9uKCB7XG4gICAgICAgICAgICAgICAgICAgIHJlc2l6ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYnRuLnJlbW92ZUNsYXNzKCAnYWN0aXZlJyApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2NoYW5nZUFjdGl2ZSA9IGZ1bmN0aW9uKCBlbGVtICkge1xuXG4gICAgICAgICAgICAgICAgdmFyIGN1ckVsZW0gPSBlbGVtO1xuXG4gICAgICAgICAgICAgICAgaWYoIGN1ckVsZW0uaGFzQ2xhc3MoICdhY3RpdmUnICkgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgY3VyRWxlbS5yZW1vdmVDbGFzcyggJ2FjdGl2ZScgKTtcblxuXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICBjdXJFbGVtLmFkZENsYXNzKCAnYWN0aXZlJyApO1xuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX3NldENvdW50ID0gZnVuY3Rpb24oIGFjdGl2ZUl0ZW0gKSB7XG4gICAgICAgICAgICAgICAgX2NvdW50QmxvY2suZmluZCggJ3NwYW46Zmlyc3QtY2hpbGQnICkudGV4dCggYWN0aXZlSXRlbSApO1xuICAgICAgICAgICAgICAgIF9jb3VudEJsb2NrLmZpbmQoICdzcGFuOmxhc3QtY2hpbGQnICkudGV4dCggX2Ryb3BNZW51SXRlbS5sZW5ndGggKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBfb2JqWyAwIF0ub2JqID0gX3NlbGY7XG4gICAgICAgICAgICAgICAgX2FkZEV2ZW50cygpO1xuICAgICAgICAgICAgICAgIF9zZXRDb3VudCggX2Ryb3BNZW51SXRlbS5maWx0ZXIoICcuYWN0aXZlJyApLmluZGV4KCkgKyAxICk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIC8vcHVibGljIHByb3BlcnRpZXNcblxuICAgICAgICAvL3B1YmxpYyBtZXRob2RzXG4gICAgICAgIF9zZWxmLmFkZEV2ZW50c0FmdGVyQWpheCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgX2J0bi5vbigge1xuICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICBfY2hhbmdlQWN0aXZlKCAkKCB0aGlzICkgKTtcblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gKTtcbiAgICAgICAgICAgIF9vYmoub24oIHtcbiAgICAgICAgICAgICAgICBjbGljazogZnVuY3Rpb24oIGV2ZW50ICl7XG4gICAgICAgICAgICAgICAgICAgIGV2ZW50ID0gZXZlbnQgfHwgd2luZG93LmV2ZW50O1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICggZXZlbnQuc3RvcFByb3BhZ2F0aW9uICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudC5jYW5jZWxCdWJibGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgX2Ryb3BNZW51SXRlbS5vbigge1xuICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgY3VyRWxlbSA9ICQoIHRoaXMgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1ckVsZW1UZXh0ID0gY3VyRWxlbS50ZXh0KCksXG4gICAgICAgICAgICAgICAgICAgICAgICBtYWluVGV4dFdyYXAgPSBjdXJFbGVtLnBhcmVudHMoICcuc2luZ2xlLXBob3Rvcy1zbGlkZXJfX3NpemVzJyApLmZpbmQoICcuc2luZ2xlLXBob3Rvcy1zbGlkZXJfX3NpemVzLXNlbGVjdGVkJyApO1xuXG4gICAgICAgICAgICAgICAgICAgIF9idG4ucmVtb3ZlQ2xhc3MoICdhY3RpdmUnICk7XG4gICAgICAgICAgICAgICAgICAgIF9kcm9wTWVudUl0ZW0ucmVtb3ZlQ2xhc3MoICdhY3RpdmUnICk7XG4gICAgICAgICAgICAgICAgICAgIGN1ckVsZW0uYWRkQ2xhc3MoICdhY3RpdmUnICk7XG4gICAgICAgICAgICAgICAgICAgIG1haW5UZXh0V3JhcC50ZXh0KCBjdXJFbGVtVGV4dCApO1xuICAgICAgICAgICAgICAgICAgICBfc2V0Q291bnQoIGN1ckVsZW0uaW5kZXgoKSArIDEgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9ICk7XG4gICAgICAgIH07XG5cbiAgICAgICAgX2luaXQoKTtcbiAgICB9O1xuXG59ICkoKTtcblxuXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
