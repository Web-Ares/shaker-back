"use strict";!function(){$(function(){$.each($(".art"),function(){new CategoryChangeContent($(this))}),$.each($(".single-photos-slider__sizes"),function(){new DropDown($(this))})})}();var CategoryChangeContent=function(e){var t,i,s=this,n=e,a=new XMLHttpRequest,o=$(window),r=$(window).height(),c=$("body"),d=!0,l=!1,_=n.find(".multi-photos-slider"),f=n.find(".single-photos-slider"),h=f.find(".single-photos-slider__like"),u=n.find(".categories"),v=n.find(".categories__set"),p=n.find(".art__sliders"),g=u.find(".categories__btn"),m=u.find(".categories__name"),C=u.find(".categories__set"),w=$(".site__loading"),x=function(){g.on({click:function(){var e=$(this),t=e.data("id");return w.addClass("show"),E(t),!1}}),u.on("click",".categories__set-item",function(){var e=$(this),i=e.data("slider"),s=n.find(".categories__set-active");return e.hasClass("active")||(u.find(".categories__set-item").removeClass("active"),e.addClass("active"),t.slideTo(i,500)),s.text($(this).text()),s.removeClass("opened"),!1}),o.on({resize:function(){S(_),o.width()<768&&!v.hasClass("categories__set_minimize")?b():o.width()>=768&&!v.hasClass("categories__set_minimize")&&D()},load:function(){setTimeout(function(){S(_)},1),v.hasClass("categories__set_minimize")&&b(),o.width()<768&&!v.hasClass("categories__set_minimize")&&b()}}),n.on("click",".single-photos-slider__like",function(){for(var e,t=$(this),i=t.data("id"),s=t.attr("class").split(" "),n=0;n<s.length;n++)"liked"==s[n]&&(e=s[n]);return B(t,i,e),!1}),c.on({click:function(){var e=v.find(".categories__set-active");e.hasClass("opened")&&e.removeClass("opened")}}),v.on("click",".categories__set-active",function(){var e=$(this);return e.hasClass("opened")?e.removeClass("opened"):(e.addClass("opened"),k(v.find(".categories__set-drop-down"))),!1})},k=function(e){var t=e,i=t.find("div"),s=i.outerHeight(),n=t.css("max-height");s>parseInt(n)&&t.niceScroll({horizrailenabled:!1})},z=function(){u.on("click",".categories__btn",function(){var e=$(this),t=e.data("id");return w.addClass("show"),E(t),!1}),u.on("click",".categories__set-item",function(){var e=$(this),i=e.data("slider"),s=n.find(".categories__set-active");return e.hasClass("active")||(u.find(".categories__set-item").removeClass("active"),e.addClass("active"),t.slideTo(i,500)),s.text($(this).text()),s.removeClass("opened"),!1}),o.on({resize:function(){S(n.find(".multi-photos-slider")),o.width()<768&&!v.hasClass("categories__set_minimize")?b():o.width()>=768&&!v.hasClass("categories__set_minimize")&&D()}}),u.on("click",".categories__set-item",function(){var e=$(this),i=e.data("slider"),s=n.find(".categories__set-active");return e.hasClass("active")||(u.find(".categories__set-item").removeClass("active"),e.addClass("active"),t.slideTo(i,500)),s.text($(this).text()),s.removeClass("opened"),!1}),h.on({click:function(){for(var e,t=$(this),i=t.data("id"),s=t.attr("class").split(" "),n=0;n<s.length;n++)"liked"==s[n]&&(e=s[n]);return B(t,i,e),!1}})},b=function(){d&&(d=!1,v.find(".categories__set-item").wrapAll('<div class="categories__set-drop-down"><div></div></div>'),v.prepend('<span class="categories__set-active">Landscape</span>'),v.find(".categories__set-active").text(v.find(".categories__set-item").filter(".active").text()),l=!0)},T=function(){n[0].obj=s,y(_,f),P(_),x(),v.hasClass("categories__set_minimize")&&b(),o.width()<768&&!v.hasClass("categories__set_minimize")&&b()},y=function(e,s){t=new Swiper(e,{direction:"vertical",slidesPerView:1,paginationClickable:!0,spaceBetween:27,mousewheelControl:!0,onSlideChangeEnd:function(e){u.find(".categories__set-item").removeClass("active"),u.find(".categories__set-item").filter("[data-slider = "+e.activeIndex+"]").addClass("active"),u.find(".categories__set-active").text(u.find(".categories__set-item").filter(".active").text()),$(".single-photos-slider__sizes-selected").removeClass("active")}}),i=new Swiper(s,{nextButton:".swiper-button-next",prevButton:".swiper-button-prev",spaceBetween:30,onSlideChangeEnd:function(){$(".single-photos-slider__sizes-selected").removeClass("active")}})},E=function(e){a.abort(),a=$.ajax({url:u.data("action"),dataType:"json",timeout:2e4,data:"data-id="+e,type:"GET",success:function(t){m.html(""),C.html(""),m.append('<a href="#" class="categories__btn" data-id="'+t.id+'">'+t.btn+"</a>");for(var i=0;i<t.set.length;i++)C.html(function(){$(this).append('<a href="#" class="categories__set-item" data-slider="'+i+'">'+t.set[i]+"</a>")});j(e)},error:function(e){"abort"!=e.statusText&&alert("Error!")}})},j=function(e){a.abort(),a=$.ajax({url:p.data("action"),dataType:"html",timeout:2e4,data:"data-id="+e,type:"GET",success:function(e){d=!0,l=!1,p.html(""),p.append($(e)),setTimeout(function(){y(n.find(".multi-photos-slider"),n.find(".single-photos-slider")),S(n.find(".multi-photos-slider"))},1),z(),o.width()<768&&!v.hasClass("categories__set_minimize")&&b(),$.each($(".single-photos-slider__sizes"),function(){new DropDown($(this))}),new Popup($(".popup")).show(n.find(".single-photos-slider__zoom")),setTimeout(function(){w.removeClass("show")},500)},error:function(e){"abort"!=e.statusText&&alert("Error!")}})},B=function(e,t,i){a.abort(),a=$.ajax({url:e.data("action"),dataType:"json",timeout:2e4,data:{"data-id":t,"class":i},type:"GET",success:function(t){t.like?e.removeClass("liked"):e.addClass("liked")},error:function(e){"abort"!=e.statusText&&alert("Error!")}})},D=function(){if(l){var e=v.find(".categories__set-drop-down div").html();l=!1,v.find(".categories__set-drop-down").remove(),v.find(".categories__set-active").remove(),v.append(e),d=!0}},P=function(e){e.innerHeight(r-e.offset().top)},S=function(e){r=$(window).height(),P(e),t.update()};T()},DropDown=function(e){var t=this,i=e,s=i.find(".single-photos-slider__sizes-selected"),n=i.find(".single-photos-slider__drop"),a=i.find(".single-photos-slider__count"),o=n.find("a"),r=$(window),c=$("body"),d=function(){s.on({click:function(){l($(this))}}),i.on({click:function(e){e=e||window.event,e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}}),o.on({click:function(){var e=$(this),t=e.text(),i=e.parents(".single-photos-slider__sizes").find(".single-photos-slider__sizes-selected");return s.removeClass("active"),o.removeClass("active"),e.addClass("active"),i.text(t),_(e.index()+1),!1}}),r.on({resize:function(){s.removeClass("active")}}),c.on({click:function(){s.removeClass("active")}})},l=function(e){var t=e;t.hasClass("active")?t.removeClass("active"):t.addClass("active")},_=function(e){a.find("span:first-child").text(e),a.find("span:last-child").text(o.length)},f=function(){i[0].obj=t,d(),_(o.filter(".active").index()+1)};t.addEventsAfterAjax=function(){s.on({click:function(){l($(this))}}),i.on({click:function(e){e=e||window.event,e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}}),o.on({click:function(){var e=$(this),t=e.text(),i=e.parents(".single-photos-slider__sizes").find(".single-photos-slider__sizes-selected");s.removeClass("active"),o.removeClass("active"),e.addClass("active"),i.text(t),_(e.index()+1)}})},f()};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpxdWVyeS5saW1pdGVkLWFydC5qcyJdLCJuYW1lcyI6WyIkIiwiZWFjaCIsIkNhdGVnb3J5Q2hhbmdlQ29udGVudCIsInRoaXMiLCJEcm9wRG93biIsIm9iaiIsIl9zd2lwZXJNdWx0aSIsIl9zd2lwZXJTaW5nbGUiLCJfc2VsZiIsIl9vYmoiLCJfcmVxdWVzdCIsIlhNTEh0dHBSZXF1ZXN0IiwiX3dpbmRvdyIsIndpbmRvdyIsIl93aW5kb3dIZWlnaHQiLCJoZWlnaHQiLCJfYm9keSIsIl9mbGFnQWRkIiwiX2ZsYWdSZW1vdmUiLCJfbXVsdGlTbGlkZXIiLCJmaW5kIiwiX3NpbmdsZVNsaWRlciIsIl9saWtlIiwiX2NhdGVnb3JpZXMiLCJfY2F0ZWdvcmllc1NldCIsIl9zbGlkZXJXcmFwIiwiX2J0biIsIl9uYW1lIiwiX3NldFdyYXAiLCJfbG9hZGluZyIsIl9hZGRFdmVudHMiLCJvbiIsImNsaWNrIiwiY3VySXRlbSIsImN1ckl0ZW1EYXRhSWQiLCJkYXRhIiwiYWRkQ2xhc3MiLCJfcmVxdWVzdEZvckNhdGVnb3J5Q29udGVudCIsImN1ckl0ZW1EYXRhU2xpZGVyIiwiYWN0aXZlSXRlbUJ0biIsImhhc0NsYXNzIiwicmVtb3ZlQ2xhc3MiLCJzbGlkZVRvIiwidGV4dCIsInJlc2l6ZSIsIl91cGRhdGVTbGlkZXIiLCJ3aWR0aCIsIl9jaGFuZ2VDYXRlZ29yeVZpZXciLCJfcmVzZXRTdHlsZUNhdGVnb3J5VmlldyIsImxvYWQiLCJzZXRUaW1lb3V0IiwibGlrZWQiLCJjdXJJdGVtQ2xhc3MiLCJhdHRyIiwic3BsaXQiLCJpIiwibGVuZ3RoIiwiX3JlcXVlc3RMaWtlZFBob3RvIiwiX2FkZE5pY2VTY3JvbGwiLCJlbGVtIiwiZHJvcE1lbnUiLCJkcm9wTWVudURpdiIsImRyb3BNZW51RGl2SGVpZ2h0Iiwib3V0ZXJIZWlnaHQiLCJtYXhIZWlnaHQiLCJjc3MiLCJwYXJzZUludCIsIm5pY2VTY3JvbGwiLCJob3JpenJhaWxlbmFibGVkIiwiX2FkZEV2ZW50c0FmdGVyQWpheCIsIndyYXBBbGwiLCJwcmVwZW5kIiwiZmlsdGVyIiwiX2luaXQiLCJfaW5pdFN3aXBlciIsIl9zZXRIZWlnaHQiLCJtdWx0aSIsInNpbmdsZSIsIlN3aXBlciIsImRpcmVjdGlvbiIsInNsaWRlc1BlclZpZXciLCJwYWdpbmF0aW9uQ2xpY2thYmxlIiwic3BhY2VCZXR3ZWVuIiwibW91c2V3aGVlbENvbnRyb2wiLCJvblNsaWRlQ2hhbmdlRW5kIiwic3dpcGVyIiwiYWN0aXZlSW5kZXgiLCJuZXh0QnV0dG9uIiwicHJldkJ1dHRvbiIsImFib3J0IiwiYWpheCIsInVybCIsImRhdGFUeXBlIiwidGltZW91dCIsInR5cGUiLCJzdWNjZXNzIiwiY29udGVudCIsImh0bWwiLCJhcHBlbmQiLCJpZCIsImJ0biIsInNldCIsIl9yZXF1ZXN0Rm9yU2xpZGVyQ29udGVudCIsImVycm9yIiwic3RhdHVzVGV4dCIsImFsZXJ0IiwiUG9wdXAiLCJzaG93IiwiZGF0YUNsYXNzIiwiZGF0YS1pZCIsImNsYXNzIiwibGlrZSIsIml0ZW1zIiwicmVtb3ZlIiwiaW5uZXJIZWlnaHQiLCJvZmZzZXQiLCJ0b3AiLCJ1cGRhdGUiLCJfZHJvcE1lbnUiLCJfY291bnRCbG9jayIsIl9kcm9wTWVudUl0ZW0iLCJfY2hhbmdlQWN0aXZlIiwiZXZlbnQiLCJzdG9wUHJvcGFnYXRpb24iLCJjYW5jZWxCdWJibGUiLCJjdXJFbGVtIiwiY3VyRWxlbVRleHQiLCJtYWluVGV4dFdyYXAiLCJwYXJlbnRzIiwiX3NldENvdW50IiwiaW5kZXgiLCJhY3RpdmVJdGVtIiwiYWRkRXZlbnRzQWZ0ZXJBamF4Il0sIm1hcHBpbmdzIjoiQUFBQSxjQUNBLFdBRUlBLEVBQUcsV0FFQ0EsRUFBRUMsS0FBTUQsRUFBRyxRQUFVLFdBRWpCLEdBQUlFLHVCQUF3QkYsRUFBR0csU0FJbkNILEVBQUVDLEtBQU1ELEVBQUcsZ0NBQWtDLFdBRXpDLEdBQUlJLFVBQVdKLEVBQUVHLGFBUTdCLElBQUlELHVCQUF3QixTQUFXRyxHQUduQyxHQU1J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RixFQUFRekYsU0FBVSxVQUNsQjJGLEVBQWFwRixLQUFNbUYsR0FDbkJHLEVBQVdKLEVBQVFLLFFBQVUsT0FLekN6RCIsImZpbGUiOiJsaW1pdGVkLWFydC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbiggZnVuY3Rpb24oKSB7XG5cbiAgICAkKCBmdW5jdGlvbigpIHtcblxuICAgICAgICAkLmVhY2goICQoICcuYXJ0JyApLCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgbmV3IENhdGVnb3J5Q2hhbmdlQ29udGVudCAoICQoIHRoaXMgKSApO1xuXG4gICAgICAgIH0gKTtcblxuICAgICAgICAkLmVhY2goICQoICcuc2luZ2xlLXBob3Rvcy1zbGlkZXJfX3NpemVzJyApLCBmdW5jdGlvbigpe1xuXG4gICAgICAgICAgICBuZXcgRHJvcERvd24gKCAkKHRoaXMpIClcblxuICAgICAgICB9ICk7XG5cbiAgICB9ICk7XG5cbn0gKSgpO1xuXG52YXIgQ2F0ZWdvcnlDaGFuZ2VDb250ZW50ID0gZnVuY3Rpb24gKCBvYmogKSB7XG5cbiAgICAvL3ByaXZhdGUgcHJvcGVydGllc1xuICAgIHZhciBfc2VsZiA9IHRoaXMsXG4gICAgICAgIF9vYmogPSBvYmosXG4gICAgICAgIF9yZXF1ZXN0ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCksXG4gICAgICAgIF93aW5kb3cgPSAkKCB3aW5kb3cpLFxuICAgICAgICBfd2luZG93SGVpZ2h0ID0gJCggd2luZG93KS5oZWlnaHQoKSxcbiAgICAgICAgX2JvZHkgPSAkKCAnYm9keScpLFxuICAgICAgICBfc3dpcGVyTXVsdGksXG4gICAgICAgIF9zd2lwZXJTaW5nbGUsXG4gICAgICAgIF9mbGFnQWRkID0gdHJ1ZSxcbiAgICAgICAgX2ZsYWdSZW1vdmUgPSBmYWxzZSxcbiAgICAgICAgX211bHRpU2xpZGVyID0gX29iai5maW5kKCAnLm11bHRpLXBob3Rvcy1zbGlkZXInICksXG4gICAgICAgIF9zaW5nbGVTbGlkZXIgPSBfb2JqLmZpbmQoICcuc2luZ2xlLXBob3Rvcy1zbGlkZXInICksXG4gICAgICAgIF9saWtlID0gX3NpbmdsZVNsaWRlci5maW5kKCAnLnNpbmdsZS1waG90b3Mtc2xpZGVyX19saWtlJyApLFxuICAgICAgICBfY2F0ZWdvcmllcyA9IF9vYmouZmluZCggJy5jYXRlZ29yaWVzJyApLFxuICAgICAgICBfY2F0ZWdvcmllc1NldCA9IF9vYmouZmluZCggJy5jYXRlZ29yaWVzX19zZXQnICksXG4gICAgICAgIF9zbGlkZXJXcmFwID0gX29iai5maW5kKCAnLmFydF9fc2xpZGVycycpLFxuICAgICAgICBfYnRuID0gX2NhdGVnb3JpZXMuZmluZCggJy5jYXRlZ29yaWVzX19idG4nICksXG4gICAgICAgIF9uYW1lID0gX2NhdGVnb3JpZXMuZmluZCggJy5jYXRlZ29yaWVzX19uYW1lJyApLFxuICAgICAgICBfc2V0V3JhcCA9IF9jYXRlZ29yaWVzLmZpbmQoICcuY2F0ZWdvcmllc19fc2V0JyksXG4gICAgICAgIF9sb2FkaW5nID0gJCggJy5zaXRlX19sb2FkaW5nJyApO1xuXG4gICAgLy9wcml2YXRlIG1ldGhvZHNcbiAgICB2YXIgX2FkZEV2ZW50cyA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICBfYnRuLm9uKCB7XG4gICAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY3VySXRlbSA9ICQoIHRoaXMgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1ckl0ZW1EYXRhSWQgPSBjdXJJdGVtLmRhdGEoICdpZCcgKTtcblxuICAgICAgICAgICAgICAgICAgICBfbG9hZGluZy5hZGRDbGFzcyggJ3Nob3cnICk7XG5cbiAgICAgICAgICAgICAgICAgICAgX3JlcXVlc3RGb3JDYXRlZ29yeUNvbnRlbnQoIGN1ckl0ZW1EYXRhSWQgKTtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICBfY2F0ZWdvcmllcy5vbiggJ2NsaWNrJywgJy5jYXRlZ29yaWVzX19zZXQtaXRlbScsIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIGN1ckl0ZW0gPSAkKCB0aGlzKSxcbiAgICAgICAgICAgICAgICAgICAgY3VySXRlbURhdGFTbGlkZXIgPSBjdXJJdGVtLmRhdGEoICdzbGlkZXInKSxcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZlSXRlbUJ0biA9IF9vYmouZmluZCggJy5jYXRlZ29yaWVzX19zZXQtYWN0aXZlJyApO1xuXG4gICAgICAgICAgICAgICAgaWYoICEoIGN1ckl0ZW0uaGFzQ2xhc3MoICdhY3RpdmUnICkgKSApIHtcbiAgICAgICAgICAgICAgICAgICAgX2NhdGVnb3JpZXMuZmluZCggJy5jYXRlZ29yaWVzX19zZXQtaXRlbScgKS5yZW1vdmVDbGFzcyggJ2FjdGl2ZScgKTtcbiAgICAgICAgICAgICAgICAgICAgY3VySXRlbS5hZGRDbGFzcyggJ2FjdGl2ZScgKTtcbiAgICAgICAgICAgICAgICAgICAgX3N3aXBlck11bHRpLnNsaWRlVG8oIGN1ckl0ZW1EYXRhU2xpZGVyLCA1MDAgKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBhY3RpdmVJdGVtQnRuLnRleHQoICQoIHRoaXMgKS50ZXh0KCkgKTtcbiAgICAgICAgICAgICAgICBhY3RpdmVJdGVtQnRuLnJlbW92ZUNsYXNzKCAnb3BlbmVkJyApO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgIF93aW5kb3cub24oIHtcbiAgICAgICAgICAgICAgICByZXNpemU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgX3VwZGF0ZVNsaWRlciggX211bHRpU2xpZGVyICk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYoIF93aW5kb3cud2lkdGgoKSA8IDc2OCAmJiAhKCBfY2F0ZWdvcmllc1NldC5oYXNDbGFzcyggJ2NhdGVnb3JpZXNfX3NldF9taW5pbWl6ZScgKSApICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX2NoYW5nZUNhdGVnb3J5VmlldygpO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiggX3dpbmRvdy53aWR0aCgpID49IDc2OCAmJiAhKCBfY2F0ZWdvcmllc1NldC5oYXNDbGFzcyggJ2NhdGVnb3JpZXNfX3NldF9taW5pbWl6ZScgKSApICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3Jlc2V0U3R5bGVDYXRlZ29yeVZpZXcoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgbG9hZDogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3VwZGF0ZVNsaWRlciggX211bHRpU2xpZGVyICk7XG4gICAgICAgICAgICAgICAgICAgIH0sIDEgKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiggX2NhdGVnb3JpZXNTZXQuaGFzQ2xhc3MoICdjYXRlZ29yaWVzX19zZXRfbWluaW1pemUnICkgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfY2hhbmdlQ2F0ZWdvcnlWaWV3KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiggX3dpbmRvdy53aWR0aCgpIDwgNzY4ICYmICEoIF9jYXRlZ29yaWVzU2V0Lmhhc0NsYXNzKCAnY2F0ZWdvcmllc19fc2V0X21pbmltaXplJyApICkgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfY2hhbmdlQ2F0ZWdvcnlWaWV3KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgIF9vYmoub24oICdjbGljaycsICcuc2luZ2xlLXBob3Rvcy1zbGlkZXJfX2xpa2UnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB2YXIgY3VySXRlbSA9ICQoIHRoaXMgKSxcbiAgICAgICAgICAgICAgICAgICAgY3VySXRlbURhdGFJZCA9IGN1ckl0ZW0uZGF0YSggJ2lkJyksXG4gICAgICAgICAgICAgICAgICAgIGN1ckl0ZW1DbGFzcyA9IGN1ckl0ZW0uYXR0ciggJ2NsYXNzJykuc3BsaXQoJyAnKSxcbiAgICAgICAgICAgICAgICAgICAgbGlrZWQ7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGN1ckl0ZW1DbGFzcy5sZW5ndGg7IGkrKykge1xuXG4gICAgICAgICAgICAgICAgICAgIGlmKCBjdXJJdGVtQ2xhc3NbaV0gPT0gJ2xpa2VkJyApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpa2VkID0gY3VySXRlbUNsYXNzW2ldO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgX3JlcXVlc3RMaWtlZFBob3RvKCBjdXJJdGVtLCBjdXJJdGVtRGF0YUlkLCBsaWtlZCApO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICBfYm9keS5vbigge1xuICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1ckl0ZW0gPSBfY2F0ZWdvcmllc1NldC5maW5kKCAnLmNhdGVnb3JpZXNfX3NldC1hY3RpdmUnICk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYoIGN1ckl0ZW0uaGFzQ2xhc3MoICdvcGVuZWQnICkgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGN1ckl0ZW0ucmVtb3ZlQ2xhc3MoICdvcGVuZWQnICk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgIF9jYXRlZ29yaWVzU2V0Lm9uKCAnY2xpY2snLCAnLmNhdGVnb3JpZXNfX3NldC1hY3RpdmUnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB2YXIgY3VySXRlbSA9ICQoIHRoaXMgKTtcblxuICAgICAgICAgICAgICAgIGlmKCAhKCBjdXJJdGVtLmhhc0NsYXNzKCAnb3BlbmVkJyApICkgKSB7XG4gICAgICAgICAgICAgICAgICAgIGN1ckl0ZW0uYWRkQ2xhc3MoICdvcGVuZWQnICk7XG4gICAgICAgICAgICAgICAgICAgIF9hZGROaWNlU2Nyb2xsKCBfY2F0ZWdvcmllc1NldC5maW5kKCAnLmNhdGVnb3JpZXNfX3NldC1kcm9wLWRvd24nICkgKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjdXJJdGVtLnJlbW92ZUNsYXNzKCAnb3BlbmVkJyApO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH0gKTtcblxuICAgICAgICB9LFxuICAgICAgICBfYWRkTmljZVNjcm9sbCA9IGZ1bmN0aW9uKCBlbGVtICkge1xuICAgICAgICAgICAgdmFyIGRyb3BNZW51ID0gZWxlbSxcbiAgICAgICAgICAgICAgICBkcm9wTWVudURpdiA9IGRyb3BNZW51LmZpbmQoICdkaXYnKSxcbiAgICAgICAgICAgICAgICBkcm9wTWVudURpdkhlaWdodCA9IGRyb3BNZW51RGl2Lm91dGVySGVpZ2h0KCksXG4gICAgICAgICAgICAgICAgbWF4SGVpZ2h0ID0gZHJvcE1lbnUuY3NzKCAnbWF4LWhlaWdodCcgKTtcblxuICAgICAgICAgICAgaWYoIGRyb3BNZW51RGl2SGVpZ2h0ID4gcGFyc2VJbnQobWF4SGVpZ2h0KSApIHtcbiAgICAgICAgICAgICAgICBkcm9wTWVudS5uaWNlU2Nyb2xsKCB7XG4gICAgICAgICAgICAgICAgICAgIGhvcml6cmFpbGVuYWJsZWQ6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBfYWRkRXZlbnRzQWZ0ZXJBamF4ID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgIF9jYXRlZ29yaWVzLm9uKCAnY2xpY2snLCAnLmNhdGVnb3JpZXNfX2J0bicsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHZhciBjdXJJdGVtID0gJCggdGhpcyApLFxuICAgICAgICAgICAgICAgICAgICBjdXJJdGVtRGF0YUlkID0gY3VySXRlbS5kYXRhKCAnaWQnICk7XG5cbiAgICAgICAgICAgICAgICBfbG9hZGluZy5hZGRDbGFzcyggJ3Nob3cnICk7XG5cbiAgICAgICAgICAgICAgICBfcmVxdWVzdEZvckNhdGVnb3J5Q29udGVudCggY3VySXRlbURhdGFJZCApO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICBfY2F0ZWdvcmllcy5vbiggJ2NsaWNrJywgJy5jYXRlZ29yaWVzX19zZXQtaXRlbScsIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIGN1ckl0ZW0gPSAkKCB0aGlzKSxcbiAgICAgICAgICAgICAgICAgICAgY3VySXRlbURhdGFTbGlkZXIgPSBjdXJJdGVtLmRhdGEoICdzbGlkZXInKSxcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZlSXRlbUJ0biA9IF9vYmouZmluZCggJy5jYXRlZ29yaWVzX19zZXQtYWN0aXZlJyApO1xuXG4gICAgICAgICAgICAgICAgaWYoICEoIGN1ckl0ZW0uaGFzQ2xhc3MoICdhY3RpdmUnICkgKSApIHtcbiAgICAgICAgICAgICAgICAgICAgX2NhdGVnb3JpZXMuZmluZCggJy5jYXRlZ29yaWVzX19zZXQtaXRlbScgKS5yZW1vdmVDbGFzcyggJ2FjdGl2ZScgKTtcbiAgICAgICAgICAgICAgICAgICAgY3VySXRlbS5hZGRDbGFzcyggJ2FjdGl2ZScgKTtcbiAgICAgICAgICAgICAgICAgICAgX3N3aXBlck11bHRpLnNsaWRlVG8oIGN1ckl0ZW1EYXRhU2xpZGVyLCA1MDAgKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBhY3RpdmVJdGVtQnRuLnRleHQoICQoIHRoaXMgKS50ZXh0KCkgKTtcbiAgICAgICAgICAgICAgICBhY3RpdmVJdGVtQnRuLnJlbW92ZUNsYXNzKCAnb3BlbmVkJyApO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgIF93aW5kb3cub24oIHtcbiAgICAgICAgICAgICAgICByZXNpemU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgX3VwZGF0ZVNsaWRlciggX29iai5maW5kKCAnLm11bHRpLXBob3Rvcy1zbGlkZXInKSApO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmKCBfd2luZG93LndpZHRoKCkgPCA3NjggJiYgISggX2NhdGVnb3JpZXNTZXQuaGFzQ2xhc3MoICdjYXRlZ29yaWVzX19zZXRfbWluaW1pemUnICkgKSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jaGFuZ2VDYXRlZ29yeVZpZXcoKTtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYoIF93aW5kb3cud2lkdGgoKSA+PSA3NjggJiYgISggX2NhdGVnb3JpZXNTZXQuaGFzQ2xhc3MoICdjYXRlZ29yaWVzX19zZXRfbWluaW1pemUnICkgKSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9yZXNldFN0eWxlQ2F0ZWdvcnlWaWV3KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgIF9jYXRlZ29yaWVzLm9uKCAnY2xpY2snLCAnLmNhdGVnb3JpZXNfX3NldC1pdGVtJywgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgY3VySXRlbSA9ICQoIHRoaXMpLFxuICAgICAgICAgICAgICAgICAgICBjdXJJdGVtRGF0YVNsaWRlciA9IGN1ckl0ZW0uZGF0YSggJ3NsaWRlcicpLFxuICAgICAgICAgICAgICAgICAgICBhY3RpdmVJdGVtQnRuID0gX29iai5maW5kKCAnLmNhdGVnb3JpZXNfX3NldC1hY3RpdmUnICk7XG5cbiAgICAgICAgICAgICAgICBpZiggISggY3VySXRlbS5oYXNDbGFzcyggJ2FjdGl2ZScgKSApICkge1xuICAgICAgICAgICAgICAgICAgICBfY2F0ZWdvcmllcy5maW5kKCAnLmNhdGVnb3JpZXNfX3NldC1pdGVtJyApLnJlbW92ZUNsYXNzKCAnYWN0aXZlJyApO1xuICAgICAgICAgICAgICAgICAgICBjdXJJdGVtLmFkZENsYXNzKCAnYWN0aXZlJyApO1xuICAgICAgICAgICAgICAgICAgICBfc3dpcGVyTXVsdGkuc2xpZGVUbyggY3VySXRlbURhdGFTbGlkZXIsIDUwMCApO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGFjdGl2ZUl0ZW1CdG4udGV4dCggJCggdGhpcyApLnRleHQoKSApO1xuICAgICAgICAgICAgICAgIGFjdGl2ZUl0ZW1CdG4ucmVtb3ZlQ2xhc3MoICdvcGVuZWQnICk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgX2xpa2Uub24oIHtcbiAgICAgICAgICAgICAgICBjbGljazogZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1ckl0ZW0gPSAkKCB0aGlzICksXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJJdGVtRGF0YUlkID0gY3VySXRlbS5kYXRhKCAnaWQnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1ckl0ZW1DbGFzcyA9IGN1ckl0ZW0uYXR0ciggJ2NsYXNzJykuc3BsaXQoJyAnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpa2VkO1xuXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY3VySXRlbUNsYXNzLmxlbmd0aDsgaSsrKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBjdXJJdGVtQ2xhc3NbaV0gPT0gJ2xpa2VkJyApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWtlZCA9IGN1ckl0ZW1DbGFzc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIF9yZXF1ZXN0TGlrZWRQaG90byggY3VySXRlbSwgY3VySXRlbURhdGFJZCwgbGlrZWQgKTtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSApO1xuXG4gICAgICAgIH0sXG4gICAgICAgIF9jaGFuZ2VDYXRlZ29yeVZpZXcgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgaWYoIF9mbGFnQWRkICkge1xuICAgICAgICAgICAgICAgIF9mbGFnQWRkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgX2NhdGVnb3JpZXNTZXQuZmluZCggJy5jYXRlZ29yaWVzX19zZXQtaXRlbScpLndyYXBBbGwoICc8ZGl2IGNsYXNzPVwiY2F0ZWdvcmllc19fc2V0LWRyb3AtZG93blwiPjxkaXY+PC9kaXY+PC9kaXY+JyApO1xuICAgICAgICAgICAgICAgIF9jYXRlZ29yaWVzU2V0LnByZXBlbmQoICc8c3BhbiBjbGFzcz1cImNhdGVnb3JpZXNfX3NldC1hY3RpdmVcIj5MYW5kc2NhcGU8L3NwYW4+JyApO1xuICAgICAgICAgICAgICAgIF9jYXRlZ29yaWVzU2V0LmZpbmQoICcuY2F0ZWdvcmllc19fc2V0LWFjdGl2ZScgKS50ZXh0KCBfY2F0ZWdvcmllc1NldC5maW5kKCAnLmNhdGVnb3JpZXNfX3NldC1pdGVtJyApLmZpbHRlciggJy5hY3RpdmUnICkudGV4dCgpICk7XG4gICAgICAgICAgICAgICAgX2ZsYWdSZW1vdmUgPSB0cnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0sXG4gICAgICAgIF9pbml0ID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgIF9vYmpbMF0ub2JqID0gX3NlbGY7XG4gICAgICAgICAgICBfaW5pdFN3aXBlciggX211bHRpU2xpZGVyLCBfc2luZ2xlU2xpZGVyICk7XG4gICAgICAgICAgICBfc2V0SGVpZ2h0KCBfbXVsdGlTbGlkZXIgKTtcbiAgICAgICAgICAgIF9hZGRFdmVudHMoKTtcbiAgICAgICAgICAgIGlmKCBfY2F0ZWdvcmllc1NldC5oYXNDbGFzcyggJ2NhdGVnb3JpZXNfX3NldF9taW5pbWl6ZScgKSApIHtcbiAgICAgICAgICAgICAgICBfY2hhbmdlQ2F0ZWdvcnlWaWV3KCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmKCBfd2luZG93LndpZHRoKCkgPCA3NjggJiYgISggX2NhdGVnb3JpZXNTZXQuaGFzQ2xhc3MoICdjYXRlZ29yaWVzX19zZXRfbWluaW1pemUnICkgKSApIHtcbiAgICAgICAgICAgICAgICBfY2hhbmdlQ2F0ZWdvcnlWaWV3KCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSxcbiAgICAgICAgX2luaXRTd2lwZXIgPSBmdW5jdGlvbiggbXVsdGksIHNpbmdsZSApIHtcblxuICAgICAgICAgICAgX3N3aXBlck11bHRpID0gbmV3IFN3aXBlciggbXVsdGksIHtcbiAgICAgICAgICAgICAgICBkaXJlY3Rpb246ICd2ZXJ0aWNhbCcsXG4gICAgICAgICAgICAgICAgc2xpZGVzUGVyVmlldzogMSxcbiAgICAgICAgICAgICAgICBwYWdpbmF0aW9uQ2xpY2thYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgIHNwYWNlQmV0d2VlbjogMjcsXG4gICAgICAgICAgICAgICAgbW91c2V3aGVlbENvbnRyb2w6IHRydWUsXG4gICAgICAgICAgICAgICAgb25TbGlkZUNoYW5nZUVuZDogZnVuY3Rpb24oIHN3aXBlciApIHtcbiAgICAgICAgICAgICAgICAgICAgX2NhdGVnb3JpZXMuZmluZCggJy5jYXRlZ29yaWVzX19zZXQtaXRlbScgKS5yZW1vdmVDbGFzcyggJ2FjdGl2ZScgKTtcbiAgICAgICAgICAgICAgICAgICAgX2NhdGVnb3JpZXMuZmluZCggJy5jYXRlZ29yaWVzX19zZXQtaXRlbScgKS5maWx0ZXIoICdbZGF0YS1zbGlkZXIgPSAnICsgc3dpcGVyLmFjdGl2ZUluZGV4ICsgJ10nKS5hZGRDbGFzcyggJ2FjdGl2ZScgKTtcbiAgICAgICAgICAgICAgICAgICAgX2NhdGVnb3JpZXMuZmluZCggJy5jYXRlZ29yaWVzX19zZXQtYWN0aXZlJyApLnRleHQoIF9jYXRlZ29yaWVzLmZpbmQoICcuY2F0ZWdvcmllc19fc2V0LWl0ZW0nICkuZmlsdGVyKCAnLmFjdGl2ZScgKS50ZXh0KCkgKTtcbiAgICAgICAgICAgICAgICAgICAgJCggJy5zaW5nbGUtcGhvdG9zLXNsaWRlcl9fc2l6ZXMtc2VsZWN0ZWQnICkucmVtb3ZlQ2xhc3MgKCAnYWN0aXZlJyApXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgX3N3aXBlclNpbmdsZSA9IG5ldyBTd2lwZXIoIHNpbmdsZSwge1xuICAgICAgICAgICAgICAgIG5leHRCdXR0b246ICcuc3dpcGVyLWJ1dHRvbi1uZXh0JyxcbiAgICAgICAgICAgICAgICBwcmV2QnV0dG9uOiAnLnN3aXBlci1idXR0b24tcHJldicsXG4gICAgICAgICAgICAgICAgc3BhY2VCZXR3ZWVuOiAzMCxcbiAgICAgICAgICAgICAgICBvblNsaWRlQ2hhbmdlRW5kOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgJCggJy5zaW5nbGUtcGhvdG9zLXNsaWRlcl9fc2l6ZXMtc2VsZWN0ZWQnICkucmVtb3ZlQ2xhc3MgKCAnYWN0aXZlJyApXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSApO1xuXG4gICAgICAgIH0sXG4gICAgICAgIF9yZXF1ZXN0Rm9yQ2F0ZWdvcnlDb250ZW50ID0gZnVuY3Rpb24oIGRhdGEgKSB7XG4gICAgICAgICAgICBfcmVxdWVzdC5hYm9ydCgpO1xuICAgICAgICAgICAgX3JlcXVlc3QgPSAkLmFqYXgoIHtcbiAgICAgICAgICAgICAgICB1cmw6IF9jYXRlZ29yaWVzLmRhdGEoICdhY3Rpb24nICksXG4gICAgICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJyxcbiAgICAgICAgICAgICAgICB0aW1lb3V0OiAyMDAwMCxcbiAgICAgICAgICAgICAgICBkYXRhOiAnZGF0YS1pZD0nICsgZGF0YSAsXG4gICAgICAgICAgICAgICAgdHlwZTogXCJHRVRcIixcbiAgICAgICAgICAgICAgICBzdWNjZXNzIDogZnVuY3Rpb24oIGNvbnRlbnQgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgX25hbWUuaHRtbCggJycgKTtcbiAgICAgICAgICAgICAgICAgICAgX3NldFdyYXAuaHRtbCggJycgKTtcblxuICAgICAgICAgICAgICAgICAgICBfbmFtZS5hcHBlbmQoICc8YSBocmVmPVwiI1wiIGNsYXNzPVwiY2F0ZWdvcmllc19fYnRuXCIgZGF0YS1pZD1cIicgKyBjb250ZW50LmlkICsgJ1wiPicgKyBjb250ZW50LmJ0biArICc8L2E+JyApO1xuXG4gICAgICAgICAgICAgICAgICAgIGZvciggdmFyIGkgPSAwOyBpIDwgY29udGVudC5zZXQubGVuZ3RoOyBpKysgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfc2V0V3JhcC5odG1sKCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCB0aGlzICkuYXBwZW5kKCAnPGEgaHJlZj1cIiNcIiBjbGFzcz1cImNhdGVnb3JpZXNfX3NldC1pdGVtXCIgZGF0YS1zbGlkZXI9XCInICsgaSArICdcIj4nICsgY29udGVudC5zZXRbIGkgXSArICc8L2E+JyApXG4gICAgICAgICAgICAgICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBfcmVxdWVzdEZvclNsaWRlckNvbnRlbnQoIGRhdGEgKTtcblxuXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKCBYTUxIdHRwUmVxdWVzdCApIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCBYTUxIdHRwUmVxdWVzdC5zdGF0dXNUZXh0ICE9IFwiYWJvcnRcIiApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KCAnRXJyb3IhJyApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSApO1xuICAgICAgICB9LFxuICAgICAgICBfcmVxdWVzdEZvclNsaWRlckNvbnRlbnQgPSBmdW5jdGlvbiggZGF0YSApIHtcbiAgICAgICAgICAgIF9yZXF1ZXN0LmFib3J0KCk7XG4gICAgICAgICAgICBfcmVxdWVzdCA9ICQuYWpheCgge1xuICAgICAgICAgICAgICAgIHVybDogX3NsaWRlcldyYXAuZGF0YSggJ2FjdGlvbicgKSxcbiAgICAgICAgICAgICAgICBkYXRhVHlwZTogJ2h0bWwnLFxuICAgICAgICAgICAgICAgIHRpbWVvdXQ6IDIwMDAwLFxuICAgICAgICAgICAgICAgIGRhdGE6ICdkYXRhLWlkPScgKyBkYXRhICxcbiAgICAgICAgICAgICAgICB0eXBlOiBcIkdFVFwiLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3MgOiBmdW5jdGlvbiggY29udGVudCApIHtcblxuICAgICAgICAgICAgICAgICAgICBfZmxhZ0FkZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIF9mbGFnUmVtb3ZlID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAgICAgX3NsaWRlcldyYXAuaHRtbCggJycgKTtcblxuICAgICAgICAgICAgICAgICAgICBfc2xpZGVyV3JhcC5hcHBlbmQoICQoIGNvbnRlbnQgKSApO1xuXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX2luaXRTd2lwZXIoIF9vYmouZmluZCggJy5tdWx0aS1waG90b3Mtc2xpZGVyJyksIF9vYmouZmluZCggJy5zaW5nbGUtcGhvdG9zLXNsaWRlcicpICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdXBkYXRlU2xpZGVyKCBfb2JqLmZpbmQoICcubXVsdGktcGhvdG9zLXNsaWRlcicpICk7XG4gICAgICAgICAgICAgICAgICAgIH0sIDEgKTtcblxuICAgICAgICAgICAgICAgICAgICBfYWRkRXZlbnRzQWZ0ZXJBamF4KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYoIF93aW5kb3cud2lkdGgoKSA8IDc2OCAmJiAhKCBfY2F0ZWdvcmllc1NldC5oYXNDbGFzcyggJ2NhdGVnb3JpZXNfX3NldF9taW5pbWl6ZScgKSApICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX2NoYW5nZUNhdGVnb3J5VmlldygpO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAkLmVhY2goICQoICcuc2luZ2xlLXBob3Rvcy1zbGlkZXJfX3NpemVzJyApLCBmdW5jdGlvbigpe1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgRHJvcERvd24gKCAkKHRoaXMpIClcblxuICAgICAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICAgICAgbmV3IFBvcHVwICggJCggJy5wb3B1cCcgKSApLnNob3coIF9vYmouZmluZCggJy5zaW5nbGUtcGhvdG9zLXNsaWRlcl9fem9vbScgKSApO1xuXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX2xvYWRpbmcucmVtb3ZlQ2xhc3MoICdzaG93JyApO1xuICAgICAgICAgICAgICAgICAgICB9LCA1MDAgKTtcblxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICggWE1MSHR0cFJlcXVlc3QgKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICggWE1MSHR0cFJlcXVlc3Quc3RhdHVzVGV4dCAhPSBcImFib3J0XCIgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbGVydCggJ0Vycm9yIScgKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gKTtcbiAgICAgICAgfSxcbiAgICAgICAgX3JlcXVlc3RMaWtlZFBob3RvID0gZnVuY3Rpb24oIGVsZW0sIGRhdGEsIGRhdGFDbGFzcyApIHtcbiAgICAgICAgICAgIF9yZXF1ZXN0LmFib3J0KCk7XG4gICAgICAgICAgICBfcmVxdWVzdCA9ICQuYWpheCgge1xuICAgICAgICAgICAgICAgIHVybDogZWxlbS5kYXRhKCAnYWN0aW9uJyApLFxuICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicsXG4gICAgICAgICAgICAgICAgdGltZW91dDogMjAwMDAsXG4gICAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICAgICAnZGF0YS1pZCc6ICBkYXRhICxcbiAgICAgICAgICAgICAgICAgICAgJ2NsYXNzJzogICAgZGF0YUNsYXNzXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB0eXBlOiBcIkdFVFwiLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3MgOiBmdW5jdGlvbiggY29udGVudCApIHtcblxuICAgICAgICAgICAgICAgICAgICBpZiggIWNvbnRlbnQubGlrZSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW0uYWRkQ2xhc3MoICdsaWtlZCcgKVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZWxlbS5yZW1vdmVDbGFzcyggJ2xpa2VkJyApXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICggWE1MSHR0cFJlcXVlc3QgKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICggWE1MSHR0cFJlcXVlc3Quc3RhdHVzVGV4dCAhPSBcImFib3J0XCIgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbGVydCggJ0Vycm9yIScgKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gKTtcbiAgICAgICAgfSxcbiAgICAgICAgX3Jlc2V0U3R5bGVDYXRlZ29yeVZpZXcgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgaWYoIF9mbGFnUmVtb3ZlICkge1xuXG4gICAgICAgICAgICAgICAgdmFyIGl0ZW1zID0gX2NhdGVnb3JpZXNTZXQuZmluZCggJy5jYXRlZ29yaWVzX19zZXQtZHJvcC1kb3duIGRpdicpLmh0bWwoKTtcblxuICAgICAgICAgICAgICAgIF9mbGFnUmVtb3ZlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgX2NhdGVnb3JpZXNTZXQuZmluZCggJy5jYXRlZ29yaWVzX19zZXQtZHJvcC1kb3duJyApLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIF9jYXRlZ29yaWVzU2V0LmZpbmQoICcuY2F0ZWdvcmllc19fc2V0LWFjdGl2ZScgKS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICBfY2F0ZWdvcmllc1NldC5hcHBlbmQoIGl0ZW1zICk7XG4gICAgICAgICAgICAgICAgX2ZsYWdBZGQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0sXG4gICAgICAgIF9zZXRIZWlnaHQgPSBmdW5jdGlvbiggbXVsdGkgKSB7XG4gICAgICAgICAgICBtdWx0aS5pbm5lckhlaWdodCggX3dpbmRvd0hlaWdodCAtIG11bHRpLm9mZnNldCgpLnRvcCApO1xuICAgICAgICB9LFxuICAgICAgICBfdXBkYXRlU2xpZGVyID0gZnVuY3Rpb24oIG11bHRpICkge1xuICAgICAgICAgICAgX3dpbmRvd0hlaWdodCA9ICQoIHdpbmRvdyApLmhlaWdodCgpO1xuICAgICAgICAgICAgX3NldEhlaWdodCggbXVsdGkgKTtcbiAgICAgICAgICAgIF9zd2lwZXJNdWx0aS51cGRhdGUoKTtcbiAgICAgICAgfTtcbiAgICBfaW5pdCgpO1xuXG59O1xuXG52YXIgRHJvcERvd24gPSBmdW5jdGlvbiAoIG9iaiApIHtcblxuICAgIC8vcHJpdmF0ZSBwcm9wZXJ0aWVzXG4gICAgdmFyIF9zZWxmID0gdGhpcyxcbiAgICAgICAgX29iaiA9IG9iaixcbiAgICAgICAgX2J0biA9IF9vYmouZmluZCggJy5zaW5nbGUtcGhvdG9zLXNsaWRlcl9fc2l6ZXMtc2VsZWN0ZWQnICksXG4gICAgICAgIF9kcm9wTWVudSA9IF9vYmouZmluZCggJy5zaW5nbGUtcGhvdG9zLXNsaWRlcl9fZHJvcCcpLFxuICAgICAgICBfY291bnRCbG9jayA9IF9vYmouZmluZCggJy5zaW5nbGUtcGhvdG9zLXNsaWRlcl9fY291bnQnKSxcbiAgICAgICAgX2Ryb3BNZW51SXRlbSA9IF9kcm9wTWVudS5maW5kKCAnYScgKSxcbiAgICAgICAgX3dpbmRvdyA9ICQoIHdpbmRvdyApLFxuICAgICAgICBfYm9keSA9ICQoICdib2R5JyApO1xuXG4gICAgLy9wcml2YXRlIG1ldGhvZHNcbiAgICB2YXIgX2FkZEV2ZW50cyA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICBfYnRuLm9uKCB7XG4gICAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgIF9jaGFuZ2VBY3RpdmUoICQoIHRoaXMgKSApO1xuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgX29iai5vbigge1xuICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbiggZXZlbnQgKXtcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQgPSBldmVudCB8fCB3aW5kb3cuZXZlbnQ7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCBldmVudC5zdG9wUHJvcGFnYXRpb24gKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LmNhbmNlbEJ1YmJsZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICBfZHJvcE1lbnVJdGVtLm9uKCB7XG4gICAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBjdXJFbGVtID0gJCggdGhpcyApLFxuICAgICAgICAgICAgICAgICAgICAgICAgY3VyRWxlbVRleHQgPSBjdXJFbGVtLnRleHQoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1haW5UZXh0V3JhcCA9IGN1ckVsZW0ucGFyZW50cyggJy5zaW5nbGUtcGhvdG9zLXNsaWRlcl9fc2l6ZXMnICkuZmluZCggJy5zaW5nbGUtcGhvdG9zLXNsaWRlcl9fc2l6ZXMtc2VsZWN0ZWQnICk7XG5cbiAgICAgICAgICAgICAgICAgICAgX2J0bi5yZW1vdmVDbGFzcyggJ2FjdGl2ZScgKTtcbiAgICAgICAgICAgICAgICAgICAgX2Ryb3BNZW51SXRlbS5yZW1vdmVDbGFzcyggJ2FjdGl2ZScgKTtcbiAgICAgICAgICAgICAgICAgICAgY3VyRWxlbS5hZGRDbGFzcyggJ2FjdGl2ZScgKTtcbiAgICAgICAgICAgICAgICAgICAgbWFpblRleHRXcmFwLnRleHQoIGN1ckVsZW1UZXh0ICk7XG4gICAgICAgICAgICAgICAgICAgIF9zZXRDb3VudCggY3VyRWxlbS5pbmRleCgpICsgMSApO1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICBfd2luZG93Lm9uKCB7XG4gICAgICAgICAgICAgICAgcmVzaXplOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgX2J0bi5yZW1vdmVDbGFzcyggJ2FjdGl2ZScgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICBfYm9keS5vbigge1xuICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgX2J0bi5yZW1vdmVDbGFzcyggJ2FjdGl2ZScgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IClcblxuICAgICAgICB9LFxuICAgICAgICBfY2hhbmdlQWN0aXZlID0gZnVuY3Rpb24oIGVsZW0gKSB7XG5cbiAgICAgICAgICAgIHZhciBjdXJFbGVtID0gZWxlbTtcblxuICAgICAgICAgICAgaWYoIGN1ckVsZW0uaGFzQ2xhc3MoICdhY3RpdmUnICkgKSB7XG5cbiAgICAgICAgICAgICAgICBjdXJFbGVtLnJlbW92ZUNsYXNzKCAnYWN0aXZlJyApO1xuXG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICBjdXJFbGVtLmFkZENsYXNzKCAnYWN0aXZlJyApO1xuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSxcbiAgICAgICAgX3NldENvdW50ID0gZnVuY3Rpb24oIGFjdGl2ZUl0ZW0gKSB7XG4gICAgICAgICAgICBfY291bnRCbG9jay5maW5kKCAnc3BhbjpmaXJzdC1jaGlsZCcgKS50ZXh0KCBhY3RpdmVJdGVtICk7XG4gICAgICAgICAgICBfY291bnRCbG9jay5maW5kKCAnc3BhbjpsYXN0LWNoaWxkJyApLnRleHQoIF9kcm9wTWVudUl0ZW0ubGVuZ3RoICk7XG4gICAgICAgIH0sXG4gICAgICAgIF9pbml0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgX29ialsgMCBdLm9iaiA9IF9zZWxmO1xuICAgICAgICAgICAgX2FkZEV2ZW50cygpO1xuICAgICAgICAgICAgX3NldENvdW50KCBfZHJvcE1lbnVJdGVtLmZpbHRlciggJy5hY3RpdmUnICkuaW5kZXgoKSArIDEgKTtcbiAgICAgICAgfTtcblxuICAgIC8vcHVibGljIHByb3BlcnRpZXNcblxuICAgIC8vcHVibGljIG1ldGhvZHNcbiAgICBfc2VsZi5hZGRFdmVudHNBZnRlckFqYXggPSBmdW5jdGlvbigpIHtcbiAgICAgICAgX2J0bi5vbigge1xuICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgX2NoYW5nZUFjdGl2ZSggJCggdGhpcyApICk7XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSApO1xuICAgICAgICBfb2JqLm9uKCB7XG4gICAgICAgICAgICBjbGljazogZnVuY3Rpb24oIGV2ZW50ICl7XG4gICAgICAgICAgICAgICAgZXZlbnQgPSBldmVudCB8fCB3aW5kb3cuZXZlbnQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoIGV2ZW50LnN0b3BQcm9wYWdhdGlvbiApIHtcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQuY2FuY2VsQnViYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gKTtcbiAgICAgICAgX2Ryb3BNZW51SXRlbS5vbigge1xuICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIGN1ckVsZW0gPSAkKCB0aGlzICksXG4gICAgICAgICAgICAgICAgICAgIGN1ckVsZW1UZXh0ID0gY3VyRWxlbS50ZXh0KCksXG4gICAgICAgICAgICAgICAgICAgIG1haW5UZXh0V3JhcCA9IGN1ckVsZW0ucGFyZW50cyggJy5zaW5nbGUtcGhvdG9zLXNsaWRlcl9fc2l6ZXMnICkuZmluZCggJy5zaW5nbGUtcGhvdG9zLXNsaWRlcl9fc2l6ZXMtc2VsZWN0ZWQnICk7XG5cbiAgICAgICAgICAgICAgICBfYnRuLnJlbW92ZUNsYXNzKCAnYWN0aXZlJyApO1xuICAgICAgICAgICAgICAgIF9kcm9wTWVudUl0ZW0ucmVtb3ZlQ2xhc3MoICdhY3RpdmUnICk7XG4gICAgICAgICAgICAgICAgY3VyRWxlbS5hZGRDbGFzcyggJ2FjdGl2ZScgKTtcbiAgICAgICAgICAgICAgICBtYWluVGV4dFdyYXAudGV4dCggY3VyRWxlbVRleHQgKTtcbiAgICAgICAgICAgICAgICBfc2V0Q291bnQoIGN1ckVsZW0uaW5kZXgoKSArIDEgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSApO1xuICAgIH07XG5cbiAgICBfaW5pdCgpO1xufTtcblxuXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
